[{"content":"ç³»ç»Ÿç¯å¢ƒ æ“ä½œç³»ç»Ÿ: Ubuntu 22.04.3 CUDAç¯å¢ƒ: 12.8 NVIDIAé©±åŠ¨: 570.124.06 cuDNNç‰ˆæœ¬: 9.10.1 ä¸€. cuDNNå®‰è£…æ­¥éª¤ 1. ä¸‹è½½cuDNN å†å²ç‰ˆæœ¬ä¸‹è½½: https://developer.nvidia.com/cudnn-archive\næœ€æ–°ç‰ˆæœ¬ä¸‹è½½: https://developer.nvidia.com/rdp/cudnn-download\nä½¿ç”¨wgetä¸‹è½½å®‰è£…åŒ…ï¼š\n1 wget https://developer.download.nvidia.com/compute/cudnn/9.10.1/local_installers/cudnn-local-repo-ubuntu2204-9.10.1_1.0-1_amd64.deb 2. å®‰è£…cuDNNåŒ… 1 dpkg -i cudnn-local-repo-ubuntu2204-9.10.1_1.0-1_amd64.deb 3. æ·»åŠ å¯†é’¥å¹¶å®‰è£… å¤åˆ¶å¯†é’¥æ–‡ä»¶ï¼š\n1 sudo cp /var/cudnn-local-repo-ubuntu2204-9.10.1/cudnn-*-keyring.gpg /usr/share/keyrings/ æ›´æ–°åŒ…åˆ—è¡¨å¹¶å®‰è£…ï¼š\n1 2 3 4 5 6 7 sudo apt-get update sudo apt-get -y install cudnn cd /var/cudnn-local-repo-ubuntu2204-9.10.1/ dpkg -i libcudnn9-samples_9.10.1.4-1_all.deb dpkg -i libcudnn9-cuda-12_9.10.1.4-1_amd64.deb dpkg -i libcudnn9-dev-cuda-12_9.10.1.4-1_amd64.deb dpkg -i libcudnn9-headers-cuda-12_9.10.1.4-1_amd64.deb äºŒ. ç¯å¢ƒéªŒè¯ 1. ç‰ˆæœ¬éªŒè¯ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥cuDNNç‰ˆæœ¬ï¼š\n1 cat /usr/include/x86_64-linux-gnu/cudnn_version.h | grep CUDNN_MAJOR -A 2 æ ¹æ®è¾“å‡ºç»“æœï¼Œç³»ç»Ÿä¸­å·²ç»æˆåŠŸå®‰è£…äº†cuDNNç‰ˆæœ¬9.10.1ã€‚\n2. æŸ¥çœ‹å®‰è£…æ–‡ä»¶è·¯å¾„(å¦‚æœæ‰¾ä¸åˆ°æ–‡ä»¶å¯å‚è€ƒæ­¤æ­¥éª¤) ä½¿ç”¨dpkgå‘½ä»¤æŸ¥çœ‹å®‰è£…çš„æ–‡ä»¶è·¯å¾„ï¼š\n1 dpkg -L \u0026lt;version\u0026gt; 3. è¿è¡Œç¤ºä¾‹ç¨‹åº è¿›å…¥cuDNNç¤ºä¾‹ç›®å½•å¹¶ç¼–è¯‘æµ‹è¯•ï¼š\n1 2 3 cd /usr/src/cudnn_samples_v9/mnistCUDNN make clean \u0026amp;\u0026amp; make ./mnistCUDNN FAQ: å¦‚æœåœ¨makeç¼–è¯‘è¿‡ç¨‹ä¸­æç¤ºç¼ºå°‘FreeImage.hï¼Œè¯·è¿è¡Œï¼š 1 sudo apt-get install libfreeimage3 libfreeimage-dev ","permalink":"https://www.itwp.cn/categories/article/cudnn01/","summary":"\u003ch2 id=\"ç³»ç»Ÿç¯å¢ƒ\"\u003eç³»ç»Ÿç¯å¢ƒ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eæ“ä½œç³»ç»Ÿ: Ubuntu 22.04.3\u003c/li\u003e\n\u003cli\u003eCUDAç¯å¢ƒ: 12.8\u003c/li\u003e\n\u003cli\u003eNVIDIAé©±åŠ¨: 570.124.06\u003c/li\u003e\n\u003cli\u003ecuDNNç‰ˆæœ¬: 9.10.1\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ä¸€-cudnnå®‰è£…æ­¥éª¤\"\u003eä¸€. cuDNNå®‰è£…æ­¥éª¤\u003c/h2\u003e\n\u003ch3 id=\"1-ä¸‹è½½cudnn\"\u003e1. ä¸‹è½½cuDNN\u003c/h3\u003e\n\u003cp\u003eå†å²ç‰ˆæœ¬ä¸‹è½½: \u003ca href=\"https://developer.nvidia.com/cudnn-archive\"\u003ehttps://developer.nvidia.com/cudnn-archive\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eæœ€æ–°ç‰ˆæœ¬ä¸‹è½½: \u003ca href=\"https://developer.nvidia.com/rdp/cudnn-download\"\u003ehttps://developer.nvidia.com/rdp/cudnn-download\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eä½¿ç”¨wgetä¸‹è½½å®‰è£…åŒ…ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://developer.download.nvidia.com/compute/cudnn/9.10.1/local_installers/cudnn-local-repo-ubuntu2204-9.10.1_1.0-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"2-å®‰è£…cudnnåŒ…\"\u003e2. å®‰è£…cuDNNåŒ…\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edpkg -i cudnn-local-repo-ubuntu2204-9.10.1_1.0-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"3-æ·»åŠ å¯†é’¥å¹¶å®‰è£…\"\u003e3. æ·»åŠ å¯†é’¥å¹¶å®‰è£…\u003c/h3\u003e\n\u003cp\u003eå¤åˆ¶å¯†é’¥æ–‡ä»¶ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-2-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo cp /var/cudnn-local-repo-ubuntu2204-9.10.1/cudnn-*-keyring.gpg /usr/share/keyrings/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eæ›´æ–°åŒ…åˆ—è¡¨å¹¶å®‰è£…ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-3-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-3\"\u003e3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-4\"\u003e4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-5\"\u003e5\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-6\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-6\"\u003e6\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-7\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-7\"\u003e7\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get update\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get -y install cudnn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /var/cudnn-local-repo-ubuntu2204-9.10.1/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edpkg -i libcudnn9-samples_9.10.1.4-1_all.deb \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edpkg -i libcudnn9-cuda-12_9.10.1.4-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edpkg -i libcudnn9-dev-cuda-12_9.10.1.4-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edpkg -i libcudnn9-headers-cuda-12_9.10.1.4-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"äºŒ-ç¯å¢ƒéªŒè¯\"\u003eäºŒ. ç¯å¢ƒéªŒè¯\u003c/h2\u003e\n\u003ch3 id=\"1-ç‰ˆæœ¬éªŒè¯\"\u003e1. ç‰ˆæœ¬éªŒè¯\u003c/h3\u003e\n\u003cp\u003eä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥cuDNNç‰ˆæœ¬ï¼š\u003c/p\u003e","title":"Ubuntuå®‰è£…CuDNN 9.10.1"},{"content":"ğŸš§ å†…å®¹å‡†å¤‡ä¸­ æ„Ÿè°¢æ‚¨è®¿é—®æˆ‘çš„åšå®¢ï¼ æ—¥å¸¸åˆ†ç±»çš„å†…å®¹æ­£åœ¨ç²¾å¿ƒå‡†å¤‡ä¸­\u0026hellip;\u0026hellip;\n","permalink":"https://www.itwp.cn/categories/everyday/preparing/","summary":"\u003ch3 id=\"-å†…å®¹å‡†å¤‡ä¸­\"\u003eğŸš§ å†…å®¹å‡†å¤‡ä¸­\u003c/h3\u003e\n\u003cp\u003eæ„Ÿè°¢æ‚¨è®¿é—®æˆ‘çš„åšå®¢ï¼\næ—¥å¸¸åˆ†ç±»çš„å†…å®¹æ­£åœ¨ç²¾å¿ƒå‡†å¤‡ä¸­\u0026hellip;\u0026hellip;\u003c/p\u003e","title":""},{"content":"ä¸ªäººç»å† æœ¬äººç²¾é€š NVIDIA Infiniband ROCE V2 AIGC Kubernetes ç­‰å•è¯çš„æ‹¼å†™\nç²¾é€š Windows Linux Ubuntu Mac IOS ç­‰ç³»ç»Ÿçš„å¼€å…³æœº\nLinuxå·¥ç¨‹å¸ˆ åŒ—äº¬ä¹è®¯ç§‘æŠ€æœ‰é™å…¬å¸ Â· åŒ—äº¬ 2021.6 - è‡³ä»Š ä¸‡å¡GPUé›†ç¾¤æ­å»ºå’Œè¿ç»´ï¼ˆROCE V2ï¼‰ å¤šä¸ªåƒå¡GPUé›†ç¾¤æ­å»ºå’Œè¿ç»´ï¼ˆInfinibandã€ROCE V2ï¼‰ AIGCé›†ç¾¤å¹¶è¡Œä¼˜åŒ–å’ŒåŒ…ç®¡ç†ï¼ˆInfinibandã€ROCE V2ï¼‰ ","permalink":"https://www.itwp.cn/categories/about/about-me/","summary":"\u003ch3 id=\"ä¸ªäººç»å†\"\u003eä¸ªäººç»å†\u003c/h3\u003e\n\u003cp\u003eæœ¬äººç²¾é€š NVIDIA Infiniband ROCE V2 AIGC Kubernetes ç­‰å•è¯çš„æ‹¼å†™\u003c/p\u003e\n\u003cp\u003eç²¾é€š Windows Linux Ubuntu Mac IOS ç­‰ç³»ç»Ÿçš„å¼€å…³æœº\u003c/p\u003e\n\u003cdiv class=\"experience-item\"\u003e\n  \u003cdiv class=\"experience-header\"\u003e\n    \u003cdiv class=\"experience-info\"\u003e\n      \u003ch4 class=\"experience-title\"\u003e\n        Linuxå·¥ç¨‹å¸ˆ\n        \u003ca\n          href=\"mailto:miaopu980516@gmail.com\"\n          class=\"email-icon\"\n          title=\"é€šè¿‡é‚®ä»¶è”ç³»æˆ‘\"\n          aria-label=\"å‘é€é‚®ä»¶ç»™æˆ‘\"\n        \u003e\n          \u003csvg\n            width=\"16\"\n            height=\"16\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            aria-hidden=\"true\"\n          \u003e\n            \u003cpath\n              d=\"M20 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z\"\n              fill=\"currentColor\"\n            /\u003e\n          \u003c/svg\u003e\n        \u003c/a\u003e\n      \u003c/h4\u003e\n      \u003cp class=\"experience-company\"\u003e\n        \u003ca\n          href=\"https://www.lexun.ltd/\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        \u003e\n          åŒ—äº¬ä¹è®¯ç§‘æŠ€æœ‰é™å…¬å¸\n        \u003c/a\u003e\n        \u003cspan class=\"location-separator\"\u003e Â· \u003c/span\u003e\n        \u003cspan class=\"experience-location\"\u003eåŒ—äº¬\u003c/span\u003e\n      \u003c/p\u003e\n    \u003c/div\u003e\n    \u003ctime class=\"experience-duration\" datetime=\"2021-06\"\u003e 2021.6 - è‡³ä»Š \u003c/time\u003e\n  \u003c/div\u003e\n  \u003cul class=\"experience-duties\"\u003e\n    \u003cli\u003eä¸‡å¡GPUé›†ç¾¤æ­å»ºå’Œè¿ç»´ï¼ˆROCE V2ï¼‰\u003c/li\u003e\n    \u003cli\u003eå¤šä¸ªåƒå¡GPUé›†ç¾¤æ­å»ºå’Œè¿ç»´ï¼ˆInfinibandã€ROCE V2ï¼‰\u003c/li\u003e\n    \u003cli\u003eAIGCé›†ç¾¤å¹¶è¡Œä¼˜åŒ–å’ŒåŒ…ç®¡ç†ï¼ˆInfinibandã€ROCE V2ï¼‰\u003c/li\u003e\n  \u003c/ul\u003e\n\u003c/div\u003e","title":""},{"content":"åœºæ™¯æè¿° OSï¼š openEuler 22.03 SP3\né¡¹ç›®æ“ä½œç³»ç»Ÿä½¿ç”¨openEuler 22.03 SP3ï¼Œåœ¨è¿›è¡Œè·¨èŠ‚ç‚¹ nccl-test æµ‹è¯•çš„æ—¶å€™å‘ç° nvidia-peermem æ— æ³•åŠ è½½ä½¿ç”¨RDMAã€‚\næ³¨æ„ï¼š H200èŠ‚ç‚¹è·¨èŠ‚ç‚¹é€šä¿¡åªæœ‰100+GBï¼Œå› ä¸ºæ²¡æœ‰å¼€å¯GDRï¼Œæ‰€ä»¥é»˜è®¤èµ°PCIEï¼Œé“¾è·¯ç“¶é¢ˆå°±åœ¨äºPCIE\næµ‹è¯•å‚æ•°åŠå¸¦å®½å¦‚ä¸‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 mpirun \\ --allow-run-as-root \\ --prefix /usr/local/openmpi \\ -H 1.1.1.1:8,1.1.1.2:8 \\ -mca btl_tcp_if_exclude lo,docker0 \\ -x LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/openmpi/lib/:/root/test_env/nccl/build/lib/ \\ -x PATH \\ -x NCCL_IB_DISABLE=0 \\ -x NCCL_IB_HCA=mlx5_0,mlx5_1,mlx5_2,mlx5_3,mlx5_4,mlx5_7,mlx5_8,mlx5_9 \\ -x NCCL_DEBUG=INFO \\ -x NCCL_IB_QPS_PER_CONNECTION=8 \\ -x NCCL_SOCKET_IFNAME=bond4.24 \\ ./build/all_reduce_perf -b 8M -e 8G -g 1 -f 2 é—®é¢˜è§£å†³ ä»GitHubæ‹‰å–nvidia-peermemè¿›è¡Œç¼–è¯‘\n1. æ‹‰å–nvidia-peermemæºç  1 sudo git clone https://github.com/Mellanox/nv_peer_memory.git 2. ç¼–è¯‘å¹¶å®‰è£…nv_peer_mem.ko 1 2 3 4 cd nv_peer_memory \u0026amp;\u0026amp; make cp nv_peer_mem.ko /lib/modules/$(uname -r)/kernel/drivers/video depmod -a modprobe nv_peer_mem 3. æ£€æŸ¥æ¨¡å—åŠ è½½çŠ¶æ€ 1 2 # å¯é€šè¿‡lsmod|grep nv_peer_memæ£€æŸ¥ lsmod|grep nv_peer_mem åŠ è½½æ¨¡å—åçš„æµ‹è¯•ç»“æœ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 mpirun \\ --allow-run-as-root \\ --prefix /usr/local/openmpi \\ -H 1.1.1.1:8,1.1.1.2:8 \\ -mca btl_tcp_if_exclude lo,docker0 \\ -x LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/openmpi/lib/:/root/test_env/nccl/build/lib/ \\ -x PATH \\ -x NCCL_IB_DISABLE=0 \\ -x NCCL_IB_HCA=mlx5_0,mlx5_1,mlx5_2,mlx5_3,mlx5_4,mlx5_7,mlx5_8,mlx5_9 \\ -x NCCL_IB_QPS_PER_CONNECTION=8 \\ -x NCCL_ALGO=Ring \\ -x NCCL_DEBUG=INFO \\ -x NCCL_SOCKET_IFNAME=enp25s0np0 \\ -x NCCL_IB_TC=160 \\ -x NCCL_NET_GDR_LEVEL=4 \\ ./build/all_reduce_perf -b 4G -e 32G -g 1 -n 20 -w 5 æ€»ç»“ é€šè¿‡ç¼–è¯‘å’ŒåŠ è½½nvidia-peermemæ¨¡å—ï¼ŒæˆåŠŸå¯ç”¨äº†GDRåŠŸèƒ½ï¼Œå¤§å¹…æå‡äº†è·¨èŠ‚ç‚¹é€šä¿¡å¸¦å®½æ€§èƒ½ã€‚ä¸»è¦æ­¥éª¤åŒ…æ‹¬ï¼š\nä»GitHubè·å–nvidia-peermemæºç  ç¼–è¯‘å¹¶å®‰è£…å†…æ ¸æ¨¡å— åŠ è½½æ¨¡å—å¹¶éªŒè¯åŠŸèƒ½ é‡æ–°è¿è¡Œæ€§èƒ½æµ‹è¯•éªŒè¯æ”¹è¿›æ•ˆæœ è¿™ä¸ªè§£å†³æ–¹æ¡ˆé€‚ç”¨äºopenEuler 22.03 SP3ç³»ç»Ÿç¯å¢ƒä¸‹çš„NVIDIA GPUé›†ç¾¤é…ç½®ã€‚\n","permalink":"https://www.itwp.cn/categories/article/gdr01/","summary":"\u003ch2 id=\"åœºæ™¯æè¿°\"\u003eåœºæ™¯æè¿°\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eOSï¼š\u003c/strong\u003e openEuler 22.03 SP3\u003c/p\u003e\n\u003cp\u003eé¡¹ç›®æ“ä½œç³»ç»Ÿä½¿ç”¨openEuler 22.03 SP3ï¼Œåœ¨è¿›è¡Œè·¨èŠ‚ç‚¹ nccl-test æµ‹è¯•çš„æ—¶å€™å‘ç° nvidia-peermem æ— æ³•åŠ è½½ä½¿ç”¨RDMAã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eæ³¨æ„ï¼š\u003c/strong\u003e H200èŠ‚ç‚¹è·¨èŠ‚ç‚¹é€šä¿¡åªæœ‰100+GBï¼Œå› ä¸ºæ²¡æœ‰å¼€å¯GDRï¼Œæ‰€ä»¥é»˜è®¤èµ°PCIEï¼Œé“¾è·¯ç“¶é¢ˆå°±åœ¨äºPCIE\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"æµ‹è¯•å‚æ•°åŠå¸¦å®½å¦‚ä¸‹\"\u003eæµ‹è¯•å‚æ•°åŠå¸¦å®½å¦‚ä¸‹\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e 1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-2\"\u003e 2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-3\"\u003e 3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-4\"\u003e 4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-5\"\u003e 5\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-6\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-6\"\u003e 6\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-7\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-7\"\u003e 7\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-8\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-8\"\u003e 8\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-9\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-9\"\u003e 9\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-10\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-10\"\u003e10\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-11\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-11\"\u003e11\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-12\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-12\"\u003e12\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-13\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-13\"\u003e13\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003empirun \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--allow-run-as-root \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--prefix /usr/local/openmpi \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-H 1.1.1.1:8,1.1.1.2:8 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-mca btl_tcp_if_exclude lo,docker0 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/cuda/lib64:/usr/local/openmpi/lib/:/root/test_env/nccl/build/lib/ \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x PATH \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_DISABLE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_HCA\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003emlx5_0,mlx5_1,mlx5_2,mlx5_3,mlx5_4,mlx5_7,mlx5_8,mlx5_9 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_DEBUG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eINFO \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_QPS_PER_CONNECTION\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_SOCKET_IFNAME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebond4.24 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e./build/all_reduce_perf -b 8M -e 8G -g \u003cspan class=\"m\"\u003e1\u003c/span\u003e -f \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"æµ‹è¯•ç»“æœæˆªå›¾1\" loading=\"lazy\" src=\"/images/gdr01/image1.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"é—®é¢˜è§£å†³\"\u003eé—®é¢˜è§£å†³\u003c/h2\u003e\n\u003cp\u003eä»GitHubæ‹‰å–nvidia-peermemè¿›è¡Œç¼–è¯‘\u003c/p\u003e\n\u003ch3 id=\"1-æ‹‰å–nvidia-peermemæºç \"\u003e1. æ‹‰å–nvidia-peermemæºç \u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo git clone https://github.com/Mellanox/nv_peer_memory.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"2-ç¼–è¯‘å¹¶å®‰è£…nv_peer_memko\"\u003e2. ç¼–è¯‘å¹¶å®‰è£…nv_peer_mem.ko\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-2-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-3\"\u003e3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-4\"\u003e4\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e nv_peer_memory \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecp nv_peer_mem.ko /lib/modules/\u003cspan class=\"k\"\u003e$(\u003c/span\u003euname -r\u003cspan class=\"k\"\u003e)\u003c/span\u003e/kernel/drivers/video\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edepmod -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emodprobe nv_peer_mem\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"3-æ£€æŸ¥æ¨¡å—åŠ è½½çŠ¶æ€\"\u003e3. æ£€æŸ¥æ¨¡å—åŠ è½½çŠ¶æ€\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-3-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-3-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å¯é€šè¿‡lsmod|grep nv_peer_memæ£€æŸ¥\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elsmod\u003cspan class=\"p\"\u003e|\u003c/span\u003egrep nv_peer_mem\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"åŠ è½½æ¨¡å—åçš„æµ‹è¯•ç»“æœ\"\u003eåŠ è½½æ¨¡å—åçš„æµ‹è¯•ç»“æœ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-4-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-1\"\u003e 1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-2\"\u003e 2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-3\"\u003e 3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-4\"\u003e 4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-5\"\u003e 5\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-6\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-6\"\u003e 6\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-7\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-7\"\u003e 7\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-8\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-8\"\u003e 8\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-9\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-9\"\u003e 9\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-10\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-10\"\u003e10\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-11\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-11\"\u003e11\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-12\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-12\"\u003e12\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-13\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-13\"\u003e13\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-14\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-14\"\u003e14\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-15\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-15\"\u003e15\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-4-16\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-4-16\"\u003e16\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003empirun \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--allow-run-as-root \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--prefix /usr/local/openmpi \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-H 1.1.1.1:8,1.1.1.2:8 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-mca btl_tcp_if_exclude lo,docker0 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/cuda/lib64:/usr/local/openmpi/lib/:/root/test_env/nccl/build/lib/ \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x PATH \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_DISABLE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_HCA\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003emlx5_0,mlx5_1,mlx5_2,mlx5_3,mlx5_4,mlx5_7,mlx5_8,mlx5_9 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_QPS_PER_CONNECTION\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_ALGO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eRing \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_DEBUG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eINFO \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_SOCKET_IFNAME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eenp25s0np0 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_IB_TC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e160\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e-x \u003cspan class=\"nv\"\u003eNCCL_NET_GDR_LEVEL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e./build/all_reduce_perf -b 4G -e 32G -g \u003cspan class=\"m\"\u003e1\u003c/span\u003e -n \u003cspan class=\"m\"\u003e20\u003c/span\u003e -w \u003cspan class=\"m\"\u003e5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"æµ‹è¯•ç»“æœæˆªå›¾2\" loading=\"lazy\" src=\"/images/gdr01/image2.png\"\u003e\u003c/p\u003e","title":"[é—®é¢˜è®°å½•]GDRæ¨¡å—æ— æ³•æ„å»º,é‡æ–°ç¼–è¯‘nvidia-peermem"},{"content":"æ¦‚è¿° åœ¨Windows Serverç¯å¢ƒä¸­ï¼Œç½‘å¡Bondï¼ˆä¹Ÿç§°ä¸ºç½‘ç»œç»„æˆ–NIC Teamingï¼‰å¯ä»¥æä¾›ç½‘ç»œå†—ä½™å’Œè´Ÿè½½å‡è¡¡ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨PowerShellåˆ›å»ºå’Œç®¡ç†ç½‘å¡Bondã€‚\nå‰ææ¡ä»¶ Windows Serverç³»ç»Ÿ è‡³å°‘ä¸¤å—ç½‘å¡ ç®¡ç†å‘˜æƒé™çš„PowerShell é…ç½®æ­¥éª¤ 1. æŸ¥çœ‹å½“å‰ç½‘å¡åˆ—è¡¨ é¦–å…ˆæ‰“å¼€PowerShellï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰ç½‘å¡è¯¦æƒ…ï¼š\n1 Get-NetAdapter æ­¤å‘½ä»¤å°†æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰ç½‘ç»œé€‚é…å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š\nç½‘å¡åç§° æ¥å£æè¿° è¿æ¥çŠ¶æ€ é“¾è·¯é€Ÿåº¦ 2. åˆ›å»ºç½‘å¡Bond ä½¿ç”¨New-NetSwitchTeamå‘½ä»¤åˆ›å»ºç½‘å¡Bondç»‘å®šã€‚æ³¨æ„ç½‘å¡åç§°ä¹‹é—´çš„ç©ºæ ¼å’Œå¼•å·ä½¿ç”¨ï¼š\n1 New-NetSwitchTeam -Name \u0026#34;bond1\u0026#34; -TeamMembers \u0026#34;ä»¥å¤ªç½‘ 2\u0026#34;,\u0026#34;ä»¥å¤ªç½‘ 3\u0026#34; å‚æ•°è¯´æ˜ï¼š\n-Nameï¼šæŒ‡å®šBondçš„åç§° -TeamMembersï¼šæŒ‡å®šè¦åŠ å…¥Bondçš„ç‰©ç†ç½‘å¡åç§° é‡è¦æç¤ºï¼šè¯·æ ¹æ®æ­¥éª¤1ä¸­Get-NetAdapterçš„è¾“å‡ºï¼Œå‡†ç¡®å¡«å†™è¦åšBondçš„ç‰©ç†ç½‘å¡åç§°ã€‚\n3. éªŒè¯Bondé…ç½® åˆ›å»ºå®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯Bondæ˜¯å¦è®¾ç½®æˆåŠŸï¼š\n3.1 ä½¿ç”¨Get-NetAdapteréªŒè¯ 1 Get-NetAdapter 3.2 ä½¿ç”¨ipconfigéªŒè¯ 1 ipconfig /all åœ¨è¾“å‡ºä¸­åº”è¯¥èƒ½çœ‹åˆ°æ–°åˆ›å»ºçš„Bondæ¥å£ï¼ˆbond1ï¼‰ï¼Œå¹¶ä¸”åŸæ¥çš„ç‰©ç†ç½‘å¡çŠ¶æ€ä¼šå‘ç”Ÿå˜åŒ–ã€‚\nVLANé…ç½®ï¼ˆå¯é€‰ï¼‰ 4. é…ç½®VLANæ ‡ç­¾ å¦‚æœä¸šåŠ¡éœ€æ±‚è¦æ±‚å°†Bondæ¥å£æ”¾é€šåˆ°ç‰¹å®šVLANï¼ˆå¦‚VLAN 128ï¼‰ï¼Œéœ€è¦åœ¨ç‰©ç†æ¥å£ä¸Šè®¾ç½®VLANæ ‡ç­¾ã€‚\næ³¨æ„ï¼šåœ¨åˆ›å»ºBondåï¼Œæ— æ³•ç›´æ¥åœ¨Bondæ¥å£ä¸Šè®¾ç½®VLANæ ‡ç­¾ï¼Œéœ€è¦åœ¨å„ä¸ªç‰©ç†æ¥å£ï¼ˆSlaveæ¥å£ï¼‰ä¸Šåˆ†åˆ«è®¾ç½®ã€‚\n4.1 æ‰“å¼€ç½‘ç»œé€‚é…å™¨è®¾ç½® æ‰“å¼€\u0026quot;ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒ\u0026quot; ç‚¹å‡»\u0026quot;æ›´æ”¹é€‚é…å™¨è®¾ç½®\u0026quot; å³é”®ç‚¹å‡»è¦é…ç½®çš„ç½‘å¡ï¼Œé€‰æ‹©\u0026quot;å±æ€§\u0026quot; é€‰æ‹©\u0026quot;Microsoft ç½‘ç»œå®¢æˆ·ç«¯\u0026quot; 4.2 è®¾ç½®VLAN ID ç‚¹å‡»\u0026quot;é…ç½®\u0026quot;æŒ‰é’® åœ¨\u0026quot;é«˜çº§\u0026quot;é€‰é¡¹å¡ä¸­æ‰¾åˆ°\u0026quot;VLAN ID\u0026quot;è®¾ç½® å¡«å†™äº¤æ¢æœºTrunkç«¯å£å¯¹åº”çš„VLANå· é…ç½®è¯´æ˜ï¼š\nVLAN IDå¿…é¡»ä¸äº¤æ¢æœºä¾§çš„é…ç½®ä¿æŒä¸€è‡´ å¦‚æœäº¤æ¢æœºä½¿ç”¨Trunkæ¨¡å¼ï¼Œéœ€è¦ç¡®ä¿VLANåœ¨å…è®¸åˆ—è¡¨ä¸­ ä¸¤ä¸ªç‰©ç†æ¥å£éƒ½éœ€è¦é…ç½®ç›¸åŒçš„VLAN ID ç®¡ç†æ“ä½œ åˆ é™¤Bondé…ç½® å¦‚æœéœ€è¦ç§»é™¤Bondé…ç½®ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 Remove-NetSwitchTeam -Name \u0026#34;bond1\u0026#34; æŸ¥çœ‹BondçŠ¶æ€ æŸ¥çœ‹ç°æœ‰çš„ç½‘ç»œç»„ï¼š\n1 Get-NetSwitchTeam æŸ¥çœ‹ç½‘ç»œç»„æˆå‘˜ï¼š\n1 Get-NetSwitchTeamMember ","permalink":"https://www.itwp.cn/categories/article/windows-bond/","summary":"\u003ch2 id=\"æ¦‚è¿°\"\u003eæ¦‚è¿°\u003c/h2\u003e\n\u003cp\u003eåœ¨Windows Serverç¯å¢ƒä¸­ï¼Œç½‘å¡Bondï¼ˆä¹Ÿç§°ä¸ºç½‘ç»œç»„æˆ–NIC Teamingï¼‰å¯ä»¥æä¾›ç½‘ç»œå†—ä½™å’Œè´Ÿè½½å‡è¡¡ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨PowerShellåˆ›å»ºå’Œç®¡ç†ç½‘å¡Bondã€‚\u003c/p\u003e\n\u003ch2 id=\"å‰ææ¡ä»¶\"\u003eå‰ææ¡ä»¶\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWindows Serverç³»ç»Ÿ\u003c/li\u003e\n\u003cli\u003eè‡³å°‘ä¸¤å—ç½‘å¡\u003c/li\u003e\n\u003cli\u003eç®¡ç†å‘˜æƒé™çš„PowerShell\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"é…ç½®æ­¥éª¤\"\u003eé…ç½®æ­¥éª¤\u003c/h2\u003e\n\u003ch3 id=\"1-æŸ¥çœ‹å½“å‰ç½‘å¡åˆ—è¡¨\"\u003e1. æŸ¥çœ‹å½“å‰ç½‘å¡åˆ—è¡¨\u003c/h3\u003e\n\u003cp\u003eé¦–å…ˆæ‰“å¼€PowerShellï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰ç½‘å¡è¯¦æƒ…ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-NetAdapter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"ç½‘å¡åˆ—è¡¨æŸ¥çœ‹\" loading=\"lazy\" src=\"/images/windows-bond/image1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæ­¤å‘½ä»¤å°†æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰ç½‘ç»œé€‚é…å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eç½‘å¡åç§°\u003c/li\u003e\n\u003cli\u003eæ¥å£æè¿°\u003c/li\u003e\n\u003cli\u003eè¿æ¥çŠ¶æ€\u003c/li\u003e\n\u003cli\u003eé“¾è·¯é€Ÿåº¦\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-åˆ›å»ºç½‘å¡bond\"\u003e2. åˆ›å»ºç½‘å¡Bond\u003c/h3\u003e\n\u003cp\u003eä½¿ç”¨\u003ccode\u003eNew-NetSwitchTeam\u003c/code\u003eå‘½ä»¤åˆ›å»ºç½‘å¡Bondç»‘å®šã€‚\u003cstrong\u003eæ³¨æ„ç½‘å¡åç§°ä¹‹é—´çš„ç©ºæ ¼å’Œå¼•å·ä½¿ç”¨\u003c/strong\u003eï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eNew-NetSwitchTeam\u003c/span\u003e \u003cspan class=\"n\"\u003e-Name\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;bond1\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003e-TeamMembers\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ä»¥å¤ªç½‘ 2\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ä»¥å¤ªç½‘ 3\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eå‚æ•°è¯´æ˜ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-Name\u003c/code\u003eï¼šæŒ‡å®šBondçš„åç§°\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-TeamMembers\u003c/code\u003eï¼šæŒ‡å®šè¦åŠ å…¥Bondçš„ç‰©ç†ç½‘å¡åç§°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eé‡è¦æç¤º\u003c/strong\u003eï¼šè¯·æ ¹æ®æ­¥éª¤1ä¸­\u003ccode\u003eGet-NetAdapter\u003c/code\u003eçš„è¾“å‡ºï¼Œå‡†ç¡®å¡«å†™è¦åšBondçš„ç‰©ç†ç½‘å¡åç§°ã€‚\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"3-éªŒè¯bondé…ç½®\"\u003e3. éªŒè¯Bondé…ç½®\u003c/h3\u003e\n\u003cp\u003eåˆ›å»ºå®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤éªŒè¯Bondæ˜¯å¦è®¾ç½®æˆåŠŸï¼š\u003c/p\u003e\n\u003ch4 id=\"31-ä½¿ç”¨get-netadapteréªŒè¯\"\u003e3.1 ä½¿ç”¨Get-NetAdapteréªŒè¯\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-2-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eGet-NetAdapter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"Bondé…ç½®éªŒè¯\" loading=\"lazy\" src=\"/images/windows-bond/image2.png\"\u003e\u003c/p\u003e\n\u003ch4 id=\"32-ä½¿ç”¨ipconfigéªŒè¯\"\u003e3.2 ä½¿ç”¨ipconfigéªŒè¯\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-3-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eipconfig\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eall\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"IPé…ç½®è¯¦æƒ…\" loading=\"lazy\" src=\"/images/windows-bond/image3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨è¾“å‡ºä¸­åº”è¯¥èƒ½çœ‹åˆ°æ–°åˆ›å»ºçš„Bondæ¥å£ï¼ˆbond1ï¼‰ï¼Œå¹¶ä¸”åŸæ¥çš„ç‰©ç†ç½‘å¡çŠ¶æ€ä¼šå‘ç”Ÿå˜åŒ–ã€‚\u003c/p\u003e\n\u003ch2 id=\"vlané…ç½®å¯é€‰\"\u003eVLANé…ç½®ï¼ˆå¯é€‰ï¼‰\u003c/h2\u003e\n\u003ch3 id=\"4-é…ç½®vlanæ ‡ç­¾\"\u003e4. é…ç½®VLANæ ‡ç­¾\u003c/h3\u003e\n\u003cp\u003eå¦‚æœä¸šåŠ¡éœ€æ±‚è¦æ±‚å°†Bondæ¥å£æ”¾é€šåˆ°ç‰¹å®šVLANï¼ˆå¦‚VLAN 128ï¼‰ï¼Œéœ€è¦åœ¨ç‰©ç†æ¥å£ä¸Šè®¾ç½®VLANæ ‡ç­¾ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eæ³¨æ„\u003c/strong\u003eï¼šåœ¨åˆ›å»ºBondåï¼Œæ— æ³•ç›´æ¥åœ¨Bondæ¥å£ä¸Šè®¾ç½®VLANæ ‡ç­¾ï¼Œéœ€è¦åœ¨å„ä¸ªç‰©ç†æ¥å£ï¼ˆSlaveæ¥å£ï¼‰ä¸Šåˆ†åˆ«è®¾ç½®ã€‚\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch4 id=\"41-æ‰“å¼€ç½‘ç»œé€‚é…å™¨è®¾ç½®\"\u003e4.1 æ‰“å¼€ç½‘ç»œé€‚é…å™¨è®¾ç½®\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eæ‰“å¼€\u0026quot;ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒ\u0026quot;\u003c/li\u003e\n\u003cli\u003eç‚¹å‡»\u0026quot;æ›´æ”¹é€‚é…å™¨è®¾ç½®\u0026quot;\u003c/li\u003e\n\u003cli\u003eå³é”®ç‚¹å‡»è¦é…ç½®çš„ç½‘å¡ï¼Œé€‰æ‹©\u0026quot;å±æ€§\u0026quot;\u003c/li\u003e\n\u003cli\u003eé€‰æ‹©\u0026quot;Microsoft ç½‘ç»œå®¢æˆ·ç«¯\u0026quot;\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg alt=\"ç½‘ç»œå®¢æˆ·ç«¯é…ç½®\" loading=\"lazy\" src=\"/images/windows-bond/image4.png\"\u003e\u003c/p\u003e\n\u003ch4 id=\"42-è®¾ç½®vlan-id\"\u003e4.2 è®¾ç½®VLAN ID\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eç‚¹å‡»\u0026quot;é…ç½®\u0026quot;æŒ‰é’®\u003c/li\u003e\n\u003cli\u003eåœ¨\u0026quot;é«˜çº§\u0026quot;é€‰é¡¹å¡ä¸­æ‰¾åˆ°\u0026quot;VLAN ID\u0026quot;è®¾ç½®\u003c/li\u003e\n\u003cli\u003eå¡«å†™äº¤æ¢æœºTrunkç«¯å£å¯¹åº”çš„VLANå·\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg alt=\"VLAN IDé…ç½®\" loading=\"lazy\" src=\"/images/windows-bond/image5.png\"\u003e\u003c/p\u003e","title":"Windows Serverç½‘å¡Bondé…ç½®æŒ‡å—"},{"content":"ä»€ä¹ˆæ˜¯NVIDIA DCGMï¼Ÿ NVIDIA æ•°æ®ä¸­å¿ƒ GPU ç®¡ç†å™¨ (DCGM) æ˜¯ä¸€å¥—ä¸“ä¸ºç®¡ç†å’Œç›‘æ§é›†ç¾¤ç¯å¢ƒä¸­çš„ NVIDIA æ•°æ®ä¸­å¿ƒ GPU è€Œè®¾è®¡çš„ç»¼åˆå·¥å…·é›†ã€‚å®ƒä¸ºæ•°æ®ä¸­å¿ƒæä¾›äº†ä¼ä¸šçº§çš„GPUç®¡ç†è§£å†³æ–¹æ¡ˆã€‚\næ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§ ä¸»åŠ¨è¿è¡ŒçŠ¶å†µç›‘æ§ - å®æ—¶ç›‘æ§GPUå¥åº·çŠ¶æ€ å…¨é¢è¯Šæ–­ - å¤šçº§åˆ«çš„ç¡¬ä»¶è¯Šæ–­å’Œæ€§èƒ½æµ‹è¯• ç³»ç»Ÿè­¦æŠ¥ - æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿå’Œç­–ç•¥ç®¡ç† æ²»ç†ç­–ç•¥ - åŒ…æ‹¬ç”µæºå’Œæ—¶é’Ÿç®¡ç† æ˜“äºé›†æˆ - å¯è½»æ¾é›†æˆåˆ°ç°æœ‰çš„é›†ç¾¤ç®¡ç†å·¥å…·ä¸­ Kubernetesæ”¯æŒ - é€šè¿‡DCGM-Exporteræä¾›å®¹å™¨åŒ–ç¯å¢ƒæ”¯æŒ æ”¯æŒå¹³å° DCGM æ”¯æŒä»¥ä¸‹å¹³å°çš„ Linux æ“ä½œç³»ç»Ÿï¼š\nx86_64 æ¶æ„ Arm æ¶æ„ POWER (ppc64le) æ¶æ„ ç›¸å…³èµ„æº å®˜æ–¹ç½‘ç«™: https://developer.nvidia.com/dcgm GitHubä»“åº“: https://github.com/NVIDIA/DCGM æ¦‚è¿°æ–‡æ¡£: https://docs.nvidia.com/datacenter/dcgm/latest/user-guide/getting-started.html å®‰è£…DCGM Ubuntu 22.04 ç¯å¢ƒéƒ¨ç½² 1. è·å–å®‰è£…åŒ… æ ¹æ®ä½ çš„ç³»ç»Ÿæ¶æ„é€‰æ‹©å¯¹åº”çš„å®‰è£…åŒ…ï¼š\nx86æ¶æ„ï¼š\n1 2 # ä¸‹è½½åœ°å€ https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/x86_64/ ARM64æ¶æ„ï¼ˆé²²é¹ï¼‰ï¼š\n1 2 # ä¸‹è½½åœ°å€ https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/sbsa/ 2. ä¸‹è½½å’Œå®‰è£… 1 2 3 4 5 # ä¸‹è½½DCGMå®‰è£…åŒ… wget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/x86_64/datacenter-gpu-manager_3.3.6_amd64.deb # å®‰è£…DCGM sudo dpkg -i datacenter-gpu-manager_3.3.6_amd64.deb 3. éªŒè¯å®‰è£… å®‰è£…å®Œæˆåï¼Œç³»ç»Ÿä¼šåŒ…å«ä»¥ä¸‹å…³é”®äºŒè¿›åˆ¶æ–‡ä»¶ï¼š\næ–‡ä»¶è·¯å¾„ åŠŸèƒ½æè¿° /usr/bin/dcgmi DCGMç®¡ç†å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºç®¡ç†å’Œç›‘æ§NVIDIA GPU /usr/bin/dcgmproftester10 DCGMæ€§èƒ½æ£€æµ‹å·¥å…·ç¬¬10ç‰ˆ /usr/bin/dcgmproftester11 DCGMæ€§èƒ½æ£€æµ‹å·¥å…·ç¬¬11ç‰ˆ /usr/bin/dcgmproftester12 DCGMæ€§èƒ½æ£€æµ‹å·¥å…·ç¬¬12ç‰ˆï¼ˆæ¨èä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼‰ /usr/bin/nv-hostengine NVIDIAä¸»å¼•æ“æœåŠ¡ï¼Œæä¾›GPUç®¡ç†å’Œç›‘æ§çš„åº•å±‚æ”¯æŒ 4. å¯åŠ¨DCGMæœåŠ¡ 1 2 3 4 5 6 7 8 # å¯åŠ¨DCGMç³»ç»ŸæœåŠ¡ sudo systemctl start nvidia-dcgm.service # è®¾ç½®å¼€æœºè‡ªå¯ sudo systemctl enable nvidia-dcgm.service # æ£€æŸ¥æœåŠ¡çŠ¶æ€ sudo systemctl status nvidia-dcgm.service DCGMåŸºç¡€ä½¿ç”¨ å¯åŠ¨nv-hostengine 1 2 # å¯åŠ¨ä¸»æœºå¼•æ“ï¼ˆæŒ‡å®šç«¯å£å’Œç»‘å®šæ¥å£ï¼‰ nv-hostengine --port 5555 --bind-interface 127.0.0.1 è®¾å¤‡å‘ç°å’Œç®¡ç† æŸ¥çœ‹GPUè®¾å¤‡åˆ—è¡¨ 1 2 3 4 5 # å‘ç°æ‰€æœ‰GPUè®¾å¤‡ dcgmi discovery --host 127.0.0.1:5555 -l # æˆ–è€…ç®€åŒ–å‘½ä»¤ dcgmi discovery -l ç¾¤ç»„ç®¡ç† DCGMçš„å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½æ˜¯é¢å‘ç»„çš„ï¼Œå› æ­¤éœ€è¦å…ˆåˆ›å»ºGPUç»„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # æŸ¥çœ‹ç°æœ‰ç¾¤ç»„ dcgmi group -l # åˆ›å»ºç¾¤ç»„å¹¶æ·»åŠ GPUï¼ˆå°†GPU ID 0-7æ·»åŠ åˆ°group 0ï¼‰ dcgmi group -g 0 -a 0,1,2,3,4,5,6,7 # æŸ¥çœ‹ç¾¤ç»„ä¿¡æ¯ dcgmi group -g 0 -i # ä»ç¾¤ç»„ä¸­åˆ é™¤GPUè®¾å¤‡ dcgmi group -g 0 -r 0,1,2,3,4,5,6,7 # åˆ é™¤æŒ‡å®šç¾¤ç»„ dcgmi group -d 0 ç›‘æ§å’Œè¯Šæ–­åŠŸèƒ½ ç»Ÿè®¡ç›‘æ§ 1 2 3 4 5 # å¯ç”¨ç»Ÿè®¡ç›‘æ§ dcgmi stats -g 0 --enable # æŸ¥çœ‹ç‰¹å®šè¿›ç¨‹çš„ç»Ÿè®¡ä¿¡æ¯ dcgmi stats --host 127.0.0.1:39999 -g 0 -p \u0026lt;è¿›ç¨‹PID\u0026gt; -v å¥åº·æ£€æŸ¥ 1 2 3 4 5 # å¯ç”¨å¥åº·ç›‘æ§ dcgmi health -g 0 -s # æŸ¥çœ‹å½“å‰å¥åº·çŠ¶æ€ dcgmi health --check -g 0 è¯Šæ–­æµ‹è¯• DCGMæä¾›4ä¸ªçº§åˆ«çš„è¯Šæ–­æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Level 1: å¿«é€Ÿæ£€æŸ¥ï¼ˆåŸºç¡€ç³»ç»ŸéªŒè¯ï¼‰ dcgmi diag -r 1 # é€‚ç”¨åœºæ™¯ï¼šå¿«é€Ÿæ£€æŸ¥GPUé©±åŠ¨ã€CUDAçŠ¶æ€ # Level 2: ä¸­ç­‰æ£€æŸ¥ï¼ˆæ‰©å±•ç³»ç»ŸéªŒè¯ï¼‰ dcgmi diag -r 2 # é€‚ç”¨åœºæ™¯ï¼šæ£€æŸ¥æ˜¾å­˜å’Œè®¡ç®—å•å…ƒåŸºç¡€åŠŸèƒ½ï¼Œé€‚åˆæ—¥å¸¸è¿ç»´ # Level 3: é•¿æœŸæ£€æŸ¥ï¼ˆç¡¬ä»¶æ·±åº¦è¯Šæ–­ï¼‰ dcgmi diag -r 3 # é€‚ç”¨åœºæ™¯ï¼šæ·±åº¦ç¡¬ä»¶æ£€æŸ¥ï¼Œå¦‚PCIeç¨³å®šæ€§ã€æ¸©åº¦ç›‘æ§ # Level 4: æ‰©å±•æ£€æŸ¥ï¼ˆé•¿æœŸå‹åŠ›æµ‹è¯•ï¼‰ dcgmi diag -r 4 # é€‚ç”¨åœºæ™¯ï¼šé•¿æ—¶é—´å‹åŠ›æµ‹è¯•ï¼Œæ’æŸ¥å¶å‘ç¡¬ä»¶æ•…éšœ NVLinkç›‘æ§ 1 2 3 4 5 # æ£€æŸ¥NVLinké”™è¯¯è®¡æ•°å™¨ dcgmi nvlink --errors -g 0 # æŸ¥çœ‹NVLinkè¿æ¥çŠ¶æ€ dcgmi nvlink --link-status é…ç½®ç®¡ç† æŸ¥çœ‹å’Œä¿®æ”¹GPUé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # æŸ¥çœ‹å½“å‰é…ç½® dcgmi config --host 127.0.0.1:39999 -g 0 --get -v # ä¿®æ”¹è®¡ç®—æ¨¡å¼ dcgmi config --host 127.0.0.1:39999 -g 0 --set -c 2 # å¯ç”¨ECCæ¨¡å¼ dcgmi config --host 127.0.0.1:39999 -g 0 --set -e on # è®¾ç½®GPUåŠŸç‡é™åˆ¶ï¼ˆå•ä½ï¼šWï¼‰ dcgmi config --host 127.0.0.1:39999 -g 0 --set -p 300 # è®¾ç½®æ—¶é’Ÿé¢‘ç‡ï¼ˆå†…å­˜2000MHzï¼ŒSMæ—¶é’Ÿ1200MHzï¼‰ dcgmi config --host 127.0.0.1:39999 -g 0 --set -m 2000 -s 1200 ç­–ç•¥ç®¡ç† å‘Šè­¦ç­–ç•¥é…ç½® 1 2 3 4 5 6 7 8 9 10 11 # æŸ¥çœ‹å½“å‰ç­–ç•¥ dcgmi policy --host 127.0.0.1:39999 -g 0 --get # è®¾ç½®æ¸©åº¦å‘Šè­¦é˜ˆå€¼ï¼ˆæœ€å¤§æ¸©åº¦50Â°Cï¼‰ dcgmi policy --host 127.0.0.1:39999 -g 0 --set 0,0 -T 50 # åˆ·æ–°ç­–ç•¥ dcgmi policy --host 127.0.0.1:39999 -g 0 --reg # æ¸…ç©ºæ‰€æœ‰ç­–ç•¥ dcgmi policy --host 127.0.0.1:39999 -g 0 --clear DCGM Profilingæ€§èƒ½åˆ†æ åŠŸèƒ½è¦æ±‚ ä½¿ç”¨DCGM ProfilingåŠŸèƒ½éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š\nDCGMç‰ˆæœ¬ â‰¥ 1.7 NVIDIAé©±åŠ¨ç‰ˆæœ¬ â‰¥ 418.43 nv-hostengineä»¥rootèº«ä»½å¯åŠ¨ æ”¯æŒçš„GPUå‹å·ï¼šTesla V100ã€Tesla T4ç­‰ å¯è·å–çš„æ€§èƒ½æŒ‡æ ‡ æŒ‡æ ‡åç§° è¯´æ˜ Field Name Graphics Engine Activity å›¾å½¢å¼•æ“æ´»è·ƒåº¦æ¯”ç‡ PROF_GR_ENGINE_ACTIVE (ID: 1001) SM Activity SMå•å…ƒæ´»è·ƒåº¦æ¯”ç‡ PROF_SM_ACTIVE (ID: 1002) SM Occupancy SMå ç”¨ç‡ PROF_SM_OCCUPANCY (ID: 1003) Tensor Activity Tensoræ ¸å¿ƒæ´»è·ƒåº¦ PROF_PIPE_TENSOR_ACTIVE (ID: 1004) Memory BW Utilization å†…å­˜å¸¦å®½åˆ©ç”¨ç‡ PROF_DRAM_ACTIVE (ID: 1005) Engine Activity FP64/FP32/FP16/HMMA/IMMAç®¡é“æ´»è·ƒåº¦ PROF_PIPE_FPXY_ACTIVE (å¤šä¸ªID) NVLink Activity NVLinkä¼ è¾“å­—èŠ‚æ•° DEV_NVLINK_BANDWIDTH_L0 PCIe Bandwidth PCIeä¼ è¾“å­—èŠ‚æ•° PROF_PCIE_TX/RX_BYTES (ID: 1009/1010) å¸¸ç”¨åŠŸèƒ½ 1. æ—¥å¸¸ç›‘æ§ å®šæœŸè¿è¡ŒLevel 2è¯Šæ–­æ£€æŸ¥GPUåŸºç¡€åŠŸèƒ½ è®¾ç½®åˆç†çš„æ¸©åº¦å’ŒåŠŸç‡å‘Šè­¦é˜ˆå€¼ å¯ç”¨ç»Ÿè®¡ç›‘æ§è·Ÿè¸ªGPUä½¿ç”¨ç‡ 2. æ•…éšœæ’æŸ¥ ä½¿ç”¨Level 3/4è¯Šæ–­è¿›è¡Œæ·±åº¦ç¡¬ä»¶æ£€æŸ¥ ç›‘æ§NVLinké”™è¯¯è®¡æ•°å™¨è¯†åˆ«è¿æ¥é—®é¢˜ ç»“åˆhealthæ£€æŸ¥åŠŸèƒ½å®šæœŸè¯„ä¼°GPUå¥åº·çŠ¶æ€ 3. æ€§èƒ½ä¼˜åŒ– åˆ©ç”¨ProfilingåŠŸèƒ½åˆ†æGPUåˆ©ç”¨ç‡ æ ¹æ®å·¥ä½œè´Ÿè½½è°ƒæ•´æ—¶é’Ÿé¢‘ç‡å’ŒåŠŸç‡é™åˆ¶ ç›‘æ§å†…å­˜å¸¦å®½å’Œè®¡ç®—å•å…ƒå ç”¨ç‡ 4. é›†ç¾¤ç®¡ç† å°†DCGMé›†æˆåˆ°Kubernetesç¯å¢ƒä¸­ ä½¿ç”¨DCGM-Exporterå¯¼å‡ºç›‘æ§æŒ‡æ ‡åˆ°Prometheus å»ºç«‹è‡ªåŠ¨åŒ–çš„GPUå¥åº·æ£€æŸ¥æµç¨‹ ä¸ªäººå®è·µç»éªŒ åœ¨å®é™…çš„ä¸‡å¡GPUé›†ç¾¤è¿ç»´å·¥ä½œä¸­ï¼Œæˆ‘æ€»ç»“äº†ä»¥ä¸‹å‡ ç‚¹ç»éªŒï¼š\nè¿ç»´è¦ç‚¹ å®šæœŸå¥åº·æ£€æŸ¥ï¼šå»ºè®®æ¯æ—¥è¿è¡ŒLevel 2è¯Šæ–­ï¼Œæ¯å‘¨è¿›è¡ŒLevel 3æ·±åº¦æ£€æŸ¥ å‘Šè­¦ç­–ç•¥è®¾ç½®ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è®¾ç½®åˆç†çš„æ¸©åº¦ã€åŠŸç‡å‘Šè­¦é˜ˆå€¼ æ—¥å¿—ç›‘æ§ï¼šåŸºäºPrometheusã€Grafanaç›‘æ§GPUçŠ¶æ€å˜åŒ–ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸ ç›‘æ§é›†æˆ åœ¨Kubernetesç¯å¢ƒä¸­ï¼Œæ¨èä½¿ç”¨DCGM-Exporterç»“åˆPrometheuså’ŒGrafanaæ„å»ºå®Œæ•´çš„GPUç›‘æ§ä½“ç³»ï¼š\n1 2 # éƒ¨ç½²DCGM-Exporteråˆ°K8sé›†ç¾¤ kubectl apply -f https://raw.githubusercontent.com/NVIDIA/dcgm-exporter/main/deployment/dcgm-exporter.yaml ","permalink":"https://www.itwp.cn/categories/article/dcgm01/","summary":"\u003ch3 id=\"ä»€ä¹ˆæ˜¯nvidia-dcgm\"\u003eä»€ä¹ˆæ˜¯NVIDIA DCGMï¼Ÿ\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eNVIDIA æ•°æ®ä¸­å¿ƒ GPU ç®¡ç†å™¨ (DCGM)\u003c/strong\u003e æ˜¯ä¸€å¥—ä¸“ä¸ºç®¡ç†å’Œç›‘æ§é›†ç¾¤ç¯å¢ƒä¸­çš„ NVIDIA æ•°æ®ä¸­å¿ƒ GPU è€Œè®¾è®¡çš„ç»¼åˆå·¥å…·é›†ã€‚å®ƒä¸ºæ•°æ®ä¸­å¿ƒæä¾›äº†ä¼ä¸šçº§çš„GPUç®¡ç†è§£å†³æ–¹æ¡ˆã€‚\u003c/p\u003e\n\u003ch3 id=\"æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§\"\u003eæ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eä¸»åŠ¨è¿è¡ŒçŠ¶å†µç›‘æ§\u003c/strong\u003e - å®æ—¶ç›‘æ§GPUå¥åº·çŠ¶æ€\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå…¨é¢è¯Šæ–­\u003c/strong\u003e - å¤šçº§åˆ«çš„ç¡¬ä»¶è¯Šæ–­å’Œæ€§èƒ½æµ‹è¯•\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç³»ç»Ÿè­¦æŠ¥\u003c/strong\u003e - æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿå’Œç­–ç•¥ç®¡ç†\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ²»ç†ç­–ç•¥\u003c/strong\u003e - åŒ…æ‹¬ç”µæºå’Œæ—¶é’Ÿç®¡ç†\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ˜“äºé›†æˆ\u003c/strong\u003e - å¯è½»æ¾é›†æˆåˆ°ç°æœ‰çš„é›†ç¾¤ç®¡ç†å·¥å…·ä¸­\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eKubernetesæ”¯æŒ\u003c/strong\u003e - é€šè¿‡DCGM-Exporteræä¾›å®¹å™¨åŒ–ç¯å¢ƒæ”¯æŒ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"æ”¯æŒå¹³å°\"\u003eæ”¯æŒå¹³å°\u003c/h3\u003e\n\u003cp\u003eDCGM æ”¯æŒä»¥ä¸‹å¹³å°çš„ Linux æ“ä½œç³»ç»Ÿï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ex86_64\u003c/code\u003e æ¶æ„\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eArm\u003c/code\u003e æ¶æ„\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePOWER (ppc64le)\u003c/code\u003e æ¶æ„\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"ç›¸å…³èµ„æº\"\u003eç›¸å…³èµ„æº\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eå®˜æ–¹ç½‘ç«™: \u003ca href=\"https://developer.nvidia.com/dcgm\"\u003ehttps://developer.nvidia.com/dcgm\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eGitHubä»“åº“: \u003ca href=\"https://github.com/NVIDIA/DCGM\"\u003ehttps://github.com/NVIDIA/DCGM\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eæ¦‚è¿°æ–‡æ¡£: \u003ca href=\"https://docs.nvidia.com/datacenter/dcgm/latest/user-guide/getting-started.html\"\u003ehttps://docs.nvidia.com/datacenter/dcgm/latest/user-guide/getting-started.html\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"å®‰è£…dcgm\"\u003eå®‰è£…DCGM\u003c/h2\u003e\n\u003ch3 id=\"ubuntu-2204-ç¯å¢ƒéƒ¨ç½²\"\u003eUbuntu 22.04 ç¯å¢ƒéƒ¨ç½²\u003c/h3\u003e\n\u003ch4 id=\"1-è·å–å®‰è£…åŒ…\"\u003e1. è·å–å®‰è£…åŒ…\u003c/h4\u003e\n\u003cp\u003eæ ¹æ®ä½ çš„ç³»ç»Ÿæ¶æ„é€‰æ‹©å¯¹åº”çš„å®‰è£…åŒ…ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ex86æ¶æ„ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¸‹è½½åœ°å€\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/x86_64/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eARM64æ¶æ„ï¼ˆé²²é¹ï¼‰ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-1-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¸‹è½½åœ°å€  \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehttps://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/sbsa/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"2-ä¸‹è½½å’Œå®‰è£…\"\u003e2. ä¸‹è½½å’Œå®‰è£…\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-2-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-3\"\u003e3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-4\"\u003e4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-2-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-5\"\u003e5\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¸‹è½½DCGMå®‰è£…åŒ…\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2204/x86_64/datacenter-gpu-manager_3.3.6_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å®‰è£…DCGM\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo dpkg -i datacenter-gpu-manager_3.3.6_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"3-éªŒè¯å®‰è£…\"\u003e3. éªŒè¯å®‰è£…\u003c/h4\u003e\n\u003cp\u003eå®‰è£…å®Œæˆåï¼Œç³»ç»Ÿä¼šåŒ…å«ä»¥ä¸‹å…³é”®äºŒè¿›åˆ¶æ–‡ä»¶ï¼š\u003c/p\u003e","title":"NVIDIA DCGM01"},{"content":"1. lspci - æ£€æŸ¥æœ¬åœ°PCIè®¾å¤‡ æ£€æŸ¥æœ¬åœ°çš„PCIè®¾å¤‡ï¼Œç”¨äºè¯†åˆ«Mellanoxç½‘å¡ã€‚\nç¤ºä¾‹ï¼š lspci | grep -i mell\n2. ofed_info - æ£€æµ‹OFEDé©±åŠ¨ç‰ˆæœ¬ æ£€æµ‹OFEDé©±åŠ¨ç‰ˆæœ¬ä¿¡æ¯ã€‚\nç¤ºä¾‹ï¼š ofed_info -s\n3. ibstat - æŸ¥çœ‹IBç½‘å¡çŠ¶æ€ æŸ¥çœ‹æœ¬æœºçš„InfiniBandç½‘å¡çŠ¶æ€ã€‚\n4. mst - Mellanoxè½¯ä»¶ç®¡ç†å·¥å…· Mellanoxè½¯ä»¶ç®¡ç†å·¥å…·ï¼Œç”¨æ¥ç”ŸæˆIBè®¾å¤‡æè¿°ç¬¦ï¼Œæä¾›ç»™å…¶ä»–å‘½ä»¤ä½¿ç”¨ã€‚\nç¤ºä¾‹ï¼š mst start\n5. mlnx_perf - æŸ¥çœ‹ç«¯å£æ”¶å‘æµé‡ å¯ä»¥æŸ¥çœ‹ç«¯å£çš„æ”¶å‘æµé‡ã€‚\nå‚æ•°è¯´æ˜ï¼š\n-iï¼šé€‰é¡¹æ¥IBè®¾å¤‡åç§°ï¼Œå¦‚ib0, ib1\u0026hellip; -tï¼šæ¯éš”å¤šä¹…é‡‡é›†ä¸€æ¬¡ï¼Œå•ä½ç§’ -cï¼šé‡‡é›†å¤šå°‘æ¬¡ 6. ibswitches - è·å–å­ç½‘äº¤æ¢æœºä¿¡æ¯ è·å–å½“å‰å­ç½‘çš„æ‰€æœ‰äº¤æ¢æœºçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„äº¤æ¢æœºçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚\n7. ibhosts - è·å–å­ç½‘HCAä¿¡æ¯ è·å–å½“å‰å­ç½‘çš„æ‰€æœ‰HCAçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„HCAçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚\n8. ibnodes - è·å–å­ç½‘æ‰€æœ‰è®¾å¤‡ä¿¡æ¯ è·å–å½“å‰å­ç½‘çš„æ‰€æœ‰äº¤æ¢æœºå’ŒHCAçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„äº¤æ¢æœºå’ŒHCAçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚ç›¸å½“äºibhostså’Œibswitcheså‘½ä»¤çš„åˆå¹¶ã€‚\n9. ibnetdiscover - æ‰«æIBç½‘ç»œè®¾å¤‡ æ‰«æå½“å‰ç½‘ç»œä¸­çš„IBè®¾å¤‡ã€‚è¾“å‡ºå†…å®¹åŒ…æ‹¬GUIDã€ç«¯å£å·ã€LIDå·å’ŒèŠ‚ç‚¹æè¿°ä»¥åŠäº¤æ¢æœºå’ŒHCAå¡çš„è¿æ¥å…³ç³»ã€‚\n10. iblinkinfo - æ£€æŸ¥ç½‘ç»œæ‹“æ‰‘è¿æ¥ æ£€æŸ¥ç½‘ç»œæ‹“æ‰‘æ˜¯å¦æŒ‰ç…§æœ€åˆè§„åˆ’çš„ç½‘ç»œå‡†ç¡®å¹¶è¿æ¥æ­£å¸¸ï¼Œä½¿ç”¨iblinkinfoï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ‰€æœ‰èŠ‚ç‚¹å’Œäº¤æ¢æœºçš„ç«¯å£è¿æ¥æƒ…å†µã€‚\nè¾“å‡ºè§£é‡Š è¯¥äº¤æ¢æœºSW200æ€»è®¡æœ‰41ä¸ªç«¯å£ï¼Œç¬¬41ä¸ªç«¯å£è™šæ‹Ÿå‡ºæ¥ç”¨æ¥è¿›è¡ŒshieldåŠŸèƒ½ï¼Œå®é™…ä¸å­˜åœ¨ç‰©ç†ç«¯å£ã€‚ç¬¬ä¸€åˆ—è‡³æœ€åä¸€åˆ—æ˜¯æœ¬ç«¯äº¤æ¢æœºLIDç«¯å£å·ï¼Œwithï¼Œé€Ÿç‡ï¼ŒçŠ¶æ€ï¼Œç‰©ç†çŠ¶æ€ï¼Œå¯¹ç«¯LIDå·ï¼Œå¯¹ç«¯ç«¯å£å·ï¼Œå¯¹ç«¯åå­—ã€‚\næ ‡è¯†è¯´æ˜ï¼š\nâ‘  è¡¨ç¤ºè¿™å°äº¤æ¢æœºçš„GUIDå·ï¼Œå”¯ä¸€åŒºåˆ†äº¤æ¢æœºçš„æ ‡è¯† â‘¡ LIDå·ï¼Œé›†ç¾¤åˆ›å»ºæ—¶SMåˆ†é…çš„å”¯ä¸€ä¾¿äºç®¡ç†çš„lidå· â‘¢ è¡¨ç¤º1-20å·å£ä¸ºIBäº¤æ¢æ¨¡å—ä¸ç½‘å¡è¿æ¥çš„å†…éƒ¨ç«¯å£ â‘£ è¡¨ç¤º21-40ä¸ºIBäº¤æ¢æ¨¡å—å¤–éƒ¨è¿æ¥å£ â‘¤ è¡¨ç¤º41å·å£ä¸ºè™šæ‹Ÿæœºå£ï¼Œä¸ºé›†ç¾¤è·‘å‹åŠ›çš„è‡ªç”±è·¯ç”±ç«¯å£ â‘¥ è¡¨ç¤ºå½“å‰ç«¯å£çš„è¿æ¥é€Ÿç‡ï¼š4X*25.78125=100Gbps(EDR) â‘¦ è¡¨ç¤ºç½‘å¡ç«¯å£çš„lidå·åŠæ‰€å¯¹åº”çš„æœåŠ¡å™¨ â‘§ è¡¨ç¤ºIBäº¤æ¢æ¨¡å—å¤–éƒ¨è¿æ¥å£çš„lidå·ã€ç«¯å£åºåˆ—å·ã€å¯¹ç«¯è¿æ¥è®¾å¤‡çš„åç§° 11. ibdiagnet - ç½‘ç»œè¯Šæ–­å·¥å…· è¯¥æŒ‡ä»¤æ‰«ææ•´ä¸ªç½‘ç»œï¼Œè¯Šæ–­è®¾å¤‡å’Œç½‘ç»œè¿æ¥çŠ¶æ€ï¼Œå¹¶ç”ŸæˆæŠ¥å‘Šã€‚\nç¤ºä¾‹ï¼š æŸ¥çœ‹è¯¯ç ç‡ ibdiagnet --pc --get_phy_info\nç”Ÿæˆçš„æŠ¥å‘Šæ–‡ä»¶ ibdiagnet.logï¼šå…¨éƒ¨åº”ç”¨ä¿¡æ¯æŠ¥å‘Š ibdiagnet.lstï¼šç½‘ç»œæ‰€æœ‰èŠ‚ç‚¹ã€ç«¯å£å’Œé“¾è·¯ä¿¡æ¯åˆ—è¡¨ ibdiagnet.fdbsï¼šç½‘ç»œå…¨éƒ¨äº¤æ¢æœºçš„å•æ’­è½¬å‘è¡¨ ibdiagnet.mcfdbsï¼šç½‘ç»œå…¨éƒ¨äº¤æ¢æœºçš„å¤šæ’­è½¬å‘è¡¨ ibdiagnet.masksï¼šé‡å¤GUIDç«¯å£ã€èŠ‚ç‚¹æ©ç è¡¨ ibdiagnet.smï¼šç½‘ç»œæ‰€æœ‰å­ç½‘ç®¡ç†å™¨SMåˆ—è¡¨ ibdiagnet.pmï¼šç½‘ç»œé“¾è·¯çš„æ€§èƒ½ç®¡ç†å™¨è®¡æ•°å™¨ä¿¡æ¯ ibdiagnet.pkeyï¼šåˆ†åŒºä¿¡æ¯å’Œæˆå‘˜ä¸»æœºç«¯å£ä¿¡æ¯ ibdiagnet.mcgï¼šå¤šæ’­ç»„å±æ€§ï¼Œæˆå‘˜ä¸»æœºç«¯å£ä¿¡æ¯ ibdiagnet.dbï¼šå†…éƒ¨å­ç½‘æ•°æ®åº“ä¿¡æ¯ 12. sminfo - è·å–å­ç½‘ç®¡ç†å™¨ä¿¡æ¯ è·å–å½“å‰èŠ‚ç‚¹çš„å­ç½‘ç®¡ç†å™¨çš„ä¿¡æ¯ã€‚\nâš ï¸ æ³¨æ„ï¼š ç¦æ­¢æ‰¹é‡æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œä¼šå¼•èµ·opensmæœåŠ¡å¼‚å¸¸ã€‚\n13. saquery - æŸ¥çœ‹å­ç½‘ç®¡ç†å™¨ æŸ¥çœ‹å­ç½‘å†…çš„å­ç½‘ç®¡ç†å™¨ã€‚\n14. mget_temp - è·å–è®¾å¤‡æ¸©åº¦ è·å–ç½‘å¡æˆ–äº¤æ¢æœºçš„æ¸©åº¦ã€‚\n15. mlxlink - è¿æ¥çŠ¶æ€è¯Šæ–­å·¥å…· ç”¨äºæ£€æŸ¥å’Œè°ƒè¯•è¿æ¥çŠ¶æ€ä»¥åŠä¸ä¹‹ç›¸å…³çš„é—®é¢˜ã€‚\né‡è¦å‚æ•°è¯´æ˜ Speedï¼šè¡¨ç¤ºå½“å‰ç½‘å¡æ”¯æŒçš„æœ€å¤§å¸¦å®½é€Ÿç‡ Enabled Link Speedï¼šè¡¨ç¤ºå½“å‰ç½‘å¡æ”¯æŒçš„åå•†é€Ÿç‡ Support Cable Speedï¼šè¡¨ç¤ºä¸IBäº¤æ¢æ¨¡å—è¿æ¥çš„çº¿ç¼†æ”¯æŒçš„åå•†é€Ÿç‡ï¼ˆçº¢è‰²å­—ä½“è¡¨ç¤ºä¸ºå†…éƒ¨è¿æ¥æ— cableï¼‰ å¸¸ç”¨åŠŸèƒ½ æ£€æŸ¥ç«¯å£çš„è¯¯ç ç‡ï¼ˆ-cå‚æ•°ï¼‰ æŸ¥çœ‹å…‰å£çš„æ¸©åº¦ã€çº¿ç¼†é•¿åº¦ç­‰ æŸ¥è¯¢æ¨¡å—çš„ä¿¡æ¯ 16. ibportstate - ç«¯å£ç®¡ç†å·¥å…· æ¥ç®¡ç†äº¤æ¢æœºçš„ç«¯å£ï¼Œenableã€resetã€disableç­‰ç­‰ã€‚å¦‚æœäº¤æ¢æœºçš„ç«¯å£disableäº†ï¼Œè¿å¯¹ç«¯å¡çš„çŠ¶æ€å°±æ˜¯pollingã€‚\nç¤ºä¾‹ï¼š\nibportstate 127 37 enable # å¯åŠ¨lidä¸º127çš„äº¤æ¢æœºçš„37å·ç«¯å£ ibportstate 127 37 # æŸ¥çœ‹lidä¸º127çš„äº¤æ¢æœºçš„37å·ç«¯å£ 17. perfquery - æŸ¥çœ‹ç«¯å£è®¡æ•°å™¨ æŸ¥çœ‹ç«¯å£è®¡æ•°å™¨ï¼Œä¸»è¦ç”¨æ¥æ’é”™ã€‚\nç¤ºä¾‹ï¼š\nperfquery 32 2ï¼šæ˜¾ç¤ºlidå·ä¸º32çš„è®¾å¤‡çš„2å·ç«¯å£çš„è®¡æ•°å™¨ perfquery -l 26 1-10 -rï¼šåˆ†åˆ«æ˜¾ç¤ºlidå·ä¸º26çš„è®¾å¤‡çš„1-10å·ç«¯å£çš„è®¡æ•°å™¨ å‚æ•°è¯´æ˜ï¼š\n-rï¼šè¯»å–æŒ‡å®šçš„ç«¯å£è®¡æ•°å™¨ä¹‹åï¼Œé‡æ–°å¼€å§‹è®¡æ•° -lï¼šæ˜¾ç¤ºæ¯ä¸€ä¸ªç«¯å£çš„æ•°æ® -aï¼šå°†æ‰€æœ‰ç«¯å£ï¼Œæ•°æ®æ±‡èšåï¼Œå±•ç¤º 18. ib_send_bw - å¸¦å®½æµ‹è¯•å·¥å…· æµ‹è¯•ä¸¤ä¸ªèŠ‚ç‚¹çš„å¸¦å®½ã€‚\nå¸¸ç”¨å‚æ•° -aï¼šRun sizes from 2 till 2^23 -cï¼šæŒ‡å®šè¿æ¥ç±»å‹ RCï¼šé¢å‘è¿æ¥çš„å¯é æœåŠ¡ UCï¼šé¢å‘è¿æ¥çš„ä¸å¯é æœåŠ¡ UDï¼šé¢å‘æ•°æ®åŒ…çš„ä¸å¯é æœåŠ¡ -Fï¼šè¡¨ç¤ºå±è”½æ‰CPUé¢‘ç‡ç›¸å…³çš„æç¤ºä¿¡æ¯ -dï¼šè¡¨ç¤ºå¡çš„id -iï¼šæŒ‡å®šç½‘å¡çš„ç«¯å£ ä½¿ç”¨ç¤ºä¾‹ æœåŠ¡ç«¯ï¼š ib_send_bw -a -c UD -F -d mlx5_0\nå®¢æˆ·ç«¯ï¼š ib_send_bw -a -c UD -F -d mlx5_0 11.4.3.19\n19. hca_self_test.ofed - è‡ªæ£€å·¥å…· è‡ªæ£€å·¥å…·ï¼Œé€šå¸¸ç”¨äºéªŒè¯OFEDï¼ˆOpenFabrics Enterprise Distributionï¼‰è½¯ä»¶æ ˆå’Œç¡¬ä»¶è®¾å¤‡çš„å…¼å®¹æ€§ä¸åŠŸèƒ½å®Œæ•´æ€§ã€‚\nä¸»è¦åŠŸèƒ½ ç¡¬ä»¶è¯Šæ–­ï¼šæ£€æµ‹Mellanox HCAï¼ˆå¦‚ConnectXç³»åˆ—ï¼‰çš„ç‰©ç†çŠ¶æ€ï¼ˆç«¯å£ã€é“¾è·¯ã€å›ºä»¶ç­‰ï¼‰ è½¯ä»¶å…¼å®¹æ€§ï¼šéªŒè¯OFEDé©±åŠ¨ã€å›ºä»¶ç‰ˆæœ¬ã€å†…æ ¸æ¨¡å—æ˜¯å¦åŒ¹é… åŠŸèƒ½æµ‹è¯•ï¼šæ£€æŸ¥RDMAï¼ˆè¿œç¨‹ç›´æ¥å†…å­˜è®¿é—®ï¼‰ã€NVMe over Fabricsï¼ˆNVMe-oFï¼‰ç­‰é«˜çº§åŠŸèƒ½æ˜¯å¦æ­£å¸¸ ","permalink":"https://www.itwp.cn/categories/article/mellanox_cmd01/","summary":"\u003ch2 id=\"1-lspci---æ£€æŸ¥æœ¬åœ°pciè®¾å¤‡\"\u003e1. lspci - æ£€æŸ¥æœ¬åœ°PCIè®¾å¤‡\u003c/h2\u003e\n\u003cp\u003eæ£€æŸ¥æœ¬åœ°çš„PCIè®¾å¤‡ï¼Œç”¨äºè¯†åˆ«Mellanoxç½‘å¡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¤ºä¾‹ï¼š\u003c/strong\u003e \u003ccode\u003elspci | grep -i mell\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"lspciå‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235100379.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2-ofed_info---æ£€æµ‹ofedé©±åŠ¨ç‰ˆæœ¬\"\u003e2. ofed_info - æ£€æµ‹OFEDé©±åŠ¨ç‰ˆæœ¬\u003c/h2\u003e\n\u003cp\u003eæ£€æµ‹OFEDé©±åŠ¨ç‰ˆæœ¬ä¿¡æ¯ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¤ºä¾‹ï¼š\u003c/strong\u003e \u003ccode\u003eofed_info -s\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"OFEDç‰ˆæœ¬ä¿¡æ¯\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235137676.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"3-ibstat---æŸ¥çœ‹ibç½‘å¡çŠ¶æ€\"\u003e3. ibstat - æŸ¥çœ‹IBç½‘å¡çŠ¶æ€\u003c/h2\u003e\n\u003cp\u003eæŸ¥çœ‹æœ¬æœºçš„InfiniBandç½‘å¡çŠ¶æ€ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ibstatå‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235214168.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"4-mst---mellanoxè½¯ä»¶ç®¡ç†å·¥å…·\"\u003e4. mst - Mellanoxè½¯ä»¶ç®¡ç†å·¥å…·\u003c/h2\u003e\n\u003cp\u003eMellanoxè½¯ä»¶ç®¡ç†å·¥å…·ï¼Œç”¨æ¥ç”ŸæˆIBè®¾å¤‡æè¿°ç¬¦ï¼Œæä¾›ç»™å…¶ä»–å‘½ä»¤ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¤ºä¾‹ï¼š\u003c/strong\u003e \u003ccode\u003emst start\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"mstå‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235301084.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"5-mlnx_perf---æŸ¥çœ‹ç«¯å£æ”¶å‘æµé‡\"\u003e5. mlnx_perf - æŸ¥çœ‹ç«¯å£æ”¶å‘æµé‡\u003c/h2\u003e\n\u003cp\u003eå¯ä»¥æŸ¥çœ‹ç«¯å£çš„æ”¶å‘æµé‡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå‚æ•°è¯´æ˜ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-i\u003c/code\u003eï¼šé€‰é¡¹æ¥IBè®¾å¤‡åç§°ï¼Œå¦‚ib0, ib1\u0026hellip;\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-t\u003c/code\u003eï¼šæ¯éš”å¤šä¹…é‡‡é›†ä¸€æ¬¡ï¼Œå•ä½ç§’\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-c\u003c/code\u003eï¼šé‡‡é›†å¤šå°‘æ¬¡\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"mlnx_perfå‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235344273.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"6-ibswitches---è·å–å­ç½‘äº¤æ¢æœºä¿¡æ¯\"\u003e6. ibswitches - è·å–å­ç½‘äº¤æ¢æœºä¿¡æ¯\u003c/h2\u003e\n\u003cp\u003eè·å–å½“å‰å­ç½‘çš„æ‰€æœ‰äº¤æ¢æœºçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„äº¤æ¢æœºçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ibswitcheså‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235453996.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"7-ibhosts---è·å–å­ç½‘hcaä¿¡æ¯\"\u003e7. ibhosts - è·å–å­ç½‘HCAä¿¡æ¯\u003c/h2\u003e\n\u003cp\u003eè·å–å½“å‰å­ç½‘çš„æ‰€æœ‰HCAçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„HCAçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ibhostså‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235510830.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"8-ibnodes---è·å–å­ç½‘æ‰€æœ‰è®¾å¤‡ä¿¡æ¯\"\u003e8. ibnodes - è·å–å­ç½‘æ‰€æœ‰è®¾å¤‡ä¿¡æ¯\u003c/h2\u003e\n\u003cp\u003eè·å–å½“å‰å­ç½‘çš„æ‰€æœ‰äº¤æ¢æœºå’ŒHCAçš„ä¿¡æ¯ã€‚æ˜¾ç¤ºå­ç½‘å†…æ‰€æœ‰è¯†åˆ«åˆ°çš„äº¤æ¢æœºå’ŒHCAçš„GUIDã€ç«¯å£æ•°é‡ã€äº¤æ¢æœºåå­—ã€LIDå·ç­‰ã€‚ç›¸å½“äºibhostså’Œibswitcheså‘½ä»¤çš„åˆå¹¶ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ibnodeså‘½ä»¤è¾“å‡º\" loading=\"lazy\" src=\"/images/mellanox01/image-20250904235532118.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"9-ibnetdiscover---æ‰«æibç½‘ç»œè®¾å¤‡\"\u003e9. ibnetdiscover - æ‰«æIBç½‘ç»œè®¾å¤‡\u003c/h2\u003e\n\u003cp\u003eæ‰«æå½“å‰ç½‘ç»œä¸­çš„IBè®¾å¤‡ã€‚è¾“å‡ºå†…å®¹åŒ…æ‹¬GUIDã€ç«¯å£å·ã€LIDå·å’ŒèŠ‚ç‚¹æè¿°ä»¥åŠäº¤æ¢æœºå’ŒHCAå¡çš„è¿æ¥å…³ç³»ã€‚\u003c/p\u003e","title":"Mellanoxç½‘å¡å¸¸ç”¨å‘½ä»¤è¯¦è§£"},{"content":"1. æ£€æŸ¥nvidia-smiçŠ¶æ€ é¦–å…ˆä½¿ç”¨nvidia-smiå‘½ä»¤æŸ¥çœ‹å½“å‰GPUçŠ¶æ€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 ubuntu@ubuntu:~$ nvidia-smi +-----------------------------------------------------------------------------+ | NVIDIA-SMI 430.14 Driver Version: 430.14 CUDA Version: 10.2 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | |===============================+======================+======================| | 0 GeForce RTX 208... Off | 00000000:1B:00.0 Off | N/A | | 22% 42C P0 63W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 1 GeForce RTX 208... Off | 00000000:1C:00.0 Off | N/A | | 23% 43C P0 57W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 2 GeForce RTX 208... Off | 00000000:1D:00.0 Off | N/A | | 23% 43C P0 62W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 3 GeForce RTX 208... Off | 00000000:1E:00.0 Off | N/A | | 22% 42C P0 49W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 4 GeForce RTX 208... Off | 00000000:89:00.0 Off | N/A | | 22% 41C P0 75W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 5 GeForce RTX 208... Off | 00000000:8A:00.0 Off | N/A | | 22% 43C P0 63W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 6 GeForce RTX 208... Off | 00000000:8B:00.0 Off | N/A | | 22% 41C P0 50W / 250W | 0MiB / 11019MiB | 1% Default | +-------------------------------+----------------------+----------------------+ | 7 GeForce RTX 208... Off | 00000000:8C:00.0 Off | N/A | | 20% 41C P0 54W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: GPU Memory | | GPU PID Type Process name Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ 2. æ¨¡æ‹ŸGPUç§»é™¤æ“ä½œ é€šè¿‡PCIè®¾å¤‡ç®¡ç†æ¥å£æ‰‹åŠ¨ç§»é™¤ç‰¹å®šGPUï¼š\n1 ubuntu@ubuntu:~$ sudo echo 1 \u0026gt; /sys/bus/pci/devices/0000:8a:00.0/remove æ‰§è¡Œåå†æ¬¡æ£€æŸ¥nvidia-smiçŠ¶æ€ï¼š\n1 ubuntu@ubuntu:~$ nvidia-smi ç§»é™¤GPUåçš„è¾“å‡ºç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 430.14 Driver Version: 430.14 CUDA Version: 10.2 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | |===============================+======================+======================| | 0 GeForce RTX 208... Off | 00000000:1B:00.0 Off | N/A | | 22% 42C P0 63W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 1 GeForce RTX 208... Off | 00000000:1C:00.0 Off | N/A | | 24% 44C P0 55W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 2 GeForce RTX 208... Off | 00000000:1D:00.0 Off | N/A | | 23% 43C P0 61W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 3 GeForce RTX 208... Off | 00000000:1E:00.0 Off | N/A | | 22% 42C P0 50W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ | 4 GeForce RTX 208... Off | 00000000:89:00.0 Off | N/A | | 25% 44C P2 77W / 250W | 10527MiB / 11019MiB | 12% Default | +-------------------------------+----------------------+----------------------+ | 5 GeForce RTX 208... Off | 00000000:8B:00.0 Off | N/A | | 22% 40C P0 49W / 250W | 0MiB / 11019MiB | 1% Default | +-------------------------------+----------------------+----------------------+ | 6 GeForce RTX 208... Off | 00000000:8C:00.0 Off | N/A | | 19% 40C P0 54W / 250W | 0MiB / 11019MiB | 0% Default | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: GPU Memory | | GPU PID Type Process name Usage | |=============================================================================| | 4 6149 C python 10517MiB | +-----------------------------------------------------------------------------+ æ³¨ï¼š å¯ä»¥çœ‹åˆ°åŸæœ¬çš„GPU 5ï¼ˆBus ID: 8A:00.0ï¼‰å·²ç»ä¸å¯è§ï¼ŒGPUæ•°é‡ä»8ä¸ªå‡å°‘åˆ°7ä¸ªã€‚\n3. é‡æ–°æ‰«æPCIè®¾å¤‡ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°æ‰«æPCIæ€»çº¿ï¼Œå°†æ–°è®¾å¤‡æ·»åŠ åˆ°ç³»ç»Ÿä¸­ï¼š\n1 echo 1 \u0026gt; /sys/bus/pci/rescan æ­¤å‘½ä»¤ç”¨äºæ‰«æPCIæ€»çº¿ä¸Šçš„è®¾å¤‡ï¼Œå¹¶å°†æ–°è®¾å¤‡æ·»åŠ åˆ°ç³»ç»Ÿä¸­ã€‚\nè·å–GPU Bus IDä¿¡æ¯ æ–¹æ³•1ï¼šä½¿ç”¨lspciæŸ¥çœ‹VGAæ§åˆ¶å™¨ 1 ubuntu@ubuntu:~$ lspci | grep VGA è¾“å‡ºç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 03:00.0 VGA compatible controller: ASPEED Technology, Inc. ASPEED Graphics Family (rev 41) 1b:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 1c:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 1d:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 1e:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 89:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 8b:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 8c:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) æ–¹æ³•2ï¼šä½¿ç”¨nvidia-smiæŸ¥çœ‹Bus ID 1 ubuntu@ubuntu:~$ nvidia-smi -a | grep \u0026#34;Bus Id\u0026#34; è¾“å‡ºç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 Bus Id : 00000000:1B:00.0 Bus Id : 00000000:1C:00.0 Bus Id : 00000000:1D:00.0 Bus Id : 00000000:1E:00.0 Bus Id : 00000000:89:00.0 Bus Id : 00000000:8B:00.0 Bus Id : 00000000:8C:00.0 æ–¹æ³•3ï¼šä½¿ç”¨lspciæŸ¥çœ‹æ‰€æœ‰NVIDIAè®¾å¤‡ 1 ubuntu@ubuntu:~$ lspci | grep -i nvidia è¾“å‡ºç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 1b:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 1b:00.1 Audio device: NVIDIA Corporation Device 10f7 (rev a1) 1b:00.2 USB controller: NVIDIA Corporation Device 1ad6 (rev a1) 1b:00.3 Serial bus controller [0c80]: NVIDIA Corporation Device 1ad7 (rev a1) 1c:00.0 VGA compatible controller: NVIDIA Corporation Device 1e04 (rev a1) 1c:00.1 Audio device: NVIDIA Corporation Device 10f7 (rev a1) 1c:00.2 USB controller: NVIDIA Corporation Device 1ad6 (rev a1) 1c:00.3 Serial bus controller [0c80]: NVIDIA Corporation Device 1ad7 (rev a1) [...] 8a:00.1 Audio device: NVIDIA Corporation Device 10f7 (rev a1) 8a:00.2 USB controller: NVIDIA Corporation Device 1ad6 (rev a1) 8a:00.3 Serial bus controller [0c80]: NVIDIA Corporation Device 1ad7 (rev a1) [...] æ³¨æ„ï¼š åœ¨è¿™ä¸ªè¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°8a:00.1ã€8a:00.2ã€8a:00.3è®¾å¤‡å­˜åœ¨ï¼Œä½†8a:00.0ï¼ˆä¸»VGAæ§åˆ¶å™¨ï¼‰ç¼ºå¤±ï¼Œè¿™è¯å®äº†è¯¥GPUç¡®å®è¢«ç§»é™¤ã€‚\n","permalink":"https://www.itwp.cn/categories/article/no_gpu/","summary":"\u003ch3 id=\"1-æ£€æŸ¥nvidia-smiçŠ¶æ€\"\u003e1. æ£€æŸ¥nvidia-smiçŠ¶æ€\u003c/h3\u003e\n\u003cp\u003eé¦–å…ˆä½¿ç”¨\u003ccode\u003envidia-smi\u003c/code\u003eå‘½ä»¤æŸ¥çœ‹å½“å‰GPUçŠ¶æ€ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e 1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-2\"\u003e 2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-3\"\u003e 3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-4\"\u003e 4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-5\"\u003e 5\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-6\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-6\"\u003e 6\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-7\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-7\"\u003e 7\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-8\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-8\"\u003e 8\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-9\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-9\"\u003e 9\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-10\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-10\"\u003e10\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-11\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-11\"\u003e11\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-12\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-12\"\u003e12\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-13\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-13\"\u003e13\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-14\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-14\"\u003e14\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-15\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-15\"\u003e15\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-16\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-16\"\u003e16\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-17\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-17\"\u003e17\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-18\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-18\"\u003e18\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-19\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-19\"\u003e19\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-20\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-20\"\u003e20\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-21\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-21\"\u003e21\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-22\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-22\"\u003e22\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-23\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-23\"\u003e23\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-24\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-24\"\u003e24\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-25\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-25\"\u003e25\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-26\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-26\"\u003e26\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-27\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-27\"\u003e27\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-28\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-28\"\u003e28\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-29\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-29\"\u003e29\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-30\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-30\"\u003e30\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-31\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-31\"\u003e31\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-32\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-32\"\u003e32\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-33\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-33\"\u003e33\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-34\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-34\"\u003e34\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-35\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-35\"\u003e35\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-36\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-36\"\u003e36\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-37\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-37\"\u003e37\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-38\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-38\"\u003e38\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-39\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-39\"\u003e39\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eubuntu@ubuntu:~$ nvidia-smi\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-----------------------------------------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e NVIDIA-SMI 430.14       Driver Version: 430.14       CUDA Version: 10.2   \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e GPU  Name        Persistence-M\u003cspan class=\"p\"\u003e|\u003c/span\u003e Bus-Id        Disp.A \u003cspan class=\"p\"\u003e|\u003c/span\u003e Volatile Uncorr. ECC \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Fan  Temp  Perf  Pwr:Usage/Cap\u003cspan class=\"p\"\u003e|\u003c/span\u003e         Memory-Usage \u003cspan class=\"p\"\u003e|\u003c/span\u003e GPU-Util  Compute M. \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\u003cspan class=\"o\"\u003e===============================\u003c/span\u003e+\u003cspan class=\"o\"\u003e======================\u003c/span\u003e+\u003cspan class=\"o\"\u003e======================\u003c/span\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e0\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:1B:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 22%   42C    P0    63W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e1\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:1C:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 23%   43C    P0    57W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e2\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:1D:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 23%   43C    P0    62W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e3\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:1E:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 22%   42C    P0    49W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e4\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:89:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 22%   41C    P0    75W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e5\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:8A:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 22%   43C    P0    63W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e6\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:8B:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 22%   41C    P0    50W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      1%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e7\u003c/span\u003e  GeForce RTX 208...  Off  \u003cspan class=\"p\"\u003e|\u003c/span\u003e 00000000:8C:00.0 Off \u003cspan class=\"p\"\u003e|\u003c/span\u003e                  N/A \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e 20%   41C    P0    54W / 250W \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0MiB / 11019MiB \u003cspan class=\"p\"\u003e|\u003c/span\u003e      0%      Default \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------+----------------------+----------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-----------------------------------------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e Processes:                                                       GPU Memory \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e  GPU       PID   Type   Process name                             Usage      \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\u003cspan class=\"o\"\u003e=============================================================================\u003c/span\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e  No running processes found                                                 \u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-----------------------------------------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"2-æ¨¡æ‹Ÿgpuç§»é™¤æ“ä½œ\"\u003e2. æ¨¡æ‹ŸGPUç§»é™¤æ“ä½œ\u003c/h3\u003e\n\u003cp\u003eé€šè¿‡PCIè®¾å¤‡ç®¡ç†æ¥å£æ‰‹åŠ¨ç§»é™¤ç‰¹å®šGPUï¼š\u003c/p\u003e","title":"ç³»ç»Ÿä¸‹å±è”½GPUæ˜¾å¡"},{"content":"ä¸€. åŸºç¡€ç¯å¢ƒå‡†å¤‡ 1. ç³»ç»Ÿä¼˜åŒ– 1. é”å®šå†…æ ¸ç‰ˆæœ¬ é˜²æ­¢ç³»ç»Ÿè‡ªåŠ¨å‡çº§å¯¼è‡´é©±åŠ¨ä¸å…¼å®¹ï¼š\n1 apt-mark hold linux-generic linux-image-generic linux-headers-generic 2. å…³é—­è‡ªåŠ¨æ›´æ–° 1 2 sudo sed -i.bak \u0026#39;s/1/0/\u0026#39; /etc/apt/apt.conf.d/10periodic \u0026amp;\u0026gt; /dev/null sudo sed -i.bak \u0026#39;s/1/0/\u0026#39; /etc/apt/apt.conf.d/20auto-upgrades \u0026amp;\u0026gt; /dev/null 2. ä¾èµ–å®‰è£… å®‰è£…ç¼–è¯‘å¿…éœ€çš„å·¥å…·ï¼š\n1 apt install gcc make -y äºŒ. é©±åŠ¨ä¸‹è½½ 1. NVIDIA Driverä¸‹è½½ è®¿é—®NVIDIAå®˜æ–¹é©±åŠ¨ä¸‹è½½é¡µé¢ï¼š å®˜æ–¹é“¾æ¥: https://www.nvidia.cn/drivers/lookup/\næ ¹æ®æ‚¨çš„GPUå‹å·å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬é€‰æ‹©åˆé€‚çš„é©±åŠ¨ç‰ˆæœ¬ã€‚ä¸‹è½½åä¼šè·å¾—ä¸€ä¸ª.runå®‰è£…åŒ…ï¼Œç›´æ¥ä¸Šä¼ åˆ°æœåŠ¡å™¨å³å¯ã€‚\n2. CUDAä¸‹è½½ è®¿é—®NVIDIA CUDAä¸‹è½½é¡µé¢ï¼š å®˜æ–¹é“¾æ¥: https://developer.nvidia.com/cuda-downloads\né€‰æ‹©å¯¹åº”çš„æ“ä½œç³»ç»Ÿã€æ¶æ„å’Œç‰ˆæœ¬ï¼Œæ¨èä¸‹è½½.runæ ¼å¼çš„å®‰è£…åŒ…ï¼Œä¾¿äºè‡ªå®šä¹‰å®‰è£…é€‰é¡¹ã€‚\n3. NVIDIA Fabric Managerä¸‹è½½ æ³¨ï¼šä»…SXMæ¥å£çš„GPUéœ€è¦ï¼ŒPCIeæ¥å£çš„GPUä¸éœ€è¦æ­¤ç»„ä»¶ã€‚\n1 wget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2004/x86_64/nvidia-fabricmanager-535_535.154.05-1_amd64.deb ä¸‰. é©±åŠ¨å®‰è£… 1. NVIDIA Driverå®‰è£… ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…NVIDIAé©±åŠ¨ï¼ˆæ ¹æ®å®é™…ç‰ˆæœ¬å·ä¿®æ”¹ï¼‰ï¼š\n1 2 3 4 5 6 ./NVIDIA-Linux-x86_64-535.154.05.run \\ --ui=none \\ --no-questions \\ --accept-license \\ --disable-nouveau \\ --install-libglvnd 2. CUDAå®‰è£… å®‰è£…CUDA Toolkitï¼ˆæ ¹æ®å®é™…ç‰ˆæœ¬å·ä¿®æ”¹ï¼‰ï¼š\n1 2 3 4 5 6 ./cuda_12.2.0_535.154.05_linux.run \\ --silent \\ --toolkit \\ --override \\ --no-drm \\ --no-opengl-libs 3. NVIDIA Fabric Managerå®‰è£… ä»…é€‚ç”¨äºSXMæ¥å£çš„GPUï¼ˆå¦‚A800ã€A100ï¼‰ï¼š\n1 dpkg -i nvidia-fabricmanager-535_535.154.05-1_amd64.deb å››. æœåŠ¡é…ç½® 1. NVIDIA Fabric ManageræœåŠ¡ å¯ç”¨å’Œé…ç½®Fabric ManageræœåŠ¡ï¼ˆç”¨äºNVLinkè¿æ¥ï¼‰ï¼š\n1 2 3 systemctl daemon-reload systemctl start nvidia-fabricmanager systemctl enable nvidia-fabricmanager 2. NVIDIA Persistence Daemon åˆ›å»ºå¹¶å¯ç”¨NVIDIAæŒä¹…åŒ–å®ˆæŠ¤ç¨‹åºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 cat \u0026lt;\u0026lt; EOF \u0026gt; /lib/systemd/system/nvidia-persistenced.service [Unit] Description=NVIDIA Persistence Daemon After=syslog.target [Service] Type=forking PIDFile=/var/run/nvidia-persistenced/nvidia-persistenced.pid Restart=always ExecStart=/usr/bin/nvidia-persistenced --verbose ExecStopPost=/bin/rm -rf /var/run/nvidia-persistenced/* TimeoutSec=300 [Install] WantedBy=multi-user.target EOF systemctl daemon-reload systemctl enable nvidia-persistenced systemctl start nvidia-persistenced äº”. ç¯å¢ƒé…ç½® 1. CUDAç¯å¢ƒè®¾ç½® å°†CUDAè·¯å¾„æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š\n1 2 3 4 5 6 7 cat \u0026lt;\u0026lt; EOF \u0026gt;\u0026gt; /etc/profile export PATH=/usr/local/cuda/bin:$PATH export CUDA_HOME=/usr/local/cuda/ export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH export LD_LIBRARY_PATH=/usr/local/cuda/targets/x86_64-linux/lib:$LD_LIBRARY_PATH export LD_LIBRARY_PATH=/usr/local/cuda/targets/x86_64-linux/lib/stubs:$LD_LIBRARY_PATH EOF åŠ è½½ç¯å¢ƒå˜é‡ï¼š\n1 source /etc/profile å…­. ç¯å¢ƒéªŒè¯ 1. nvidia-smiéªŒè¯ è¿è¡Œnvidia-smiå‘½ä»¤éªŒè¯é©±åŠ¨å®‰è£…ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 nvidia-smi +-----------------------------------------------------------------------------+ | NVIDIA-SMI 535.154.05 Driver Version: 535.154.05 CUDA Version: 12.2 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 NVIDIA A800-SXM4-80GB On | 00000000:10:00.0 Off | 0 | | N/A 41C P0 62W / 400W | 0MiB / 81920MiB | 0% Default | | | | Disabled | +-------------------------------+----------------------+----------------------+ | 1 NVIDIA A800-SXM4-80GB On | 00000000:16:00.0 Off | 0 | | N/A 39C P0 63W / 400W | 0MiB / 81920MiB | 0% Default | | | | Disabled | +-------------------------------+----------------------+----------------------+ ... 2. NVIDIA Fabric Manager æ£€æŸ¥Fabric ManageræœåŠ¡çŠ¶æ€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 systemctl status nvidia-fabricmanager â— nvidia-fabricmanager.service - NVIDIA fabric manager service Loaded: loaded (/lib/systemd/system/nvidia-fabricmanager.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2023-05-07 08:33:50 CST; 3 months 20 days ago Main PID: 2979 (nv-fabricmanage) Tasks: 18 (limit: 629145) Memory: 17.9M CPU: 19min 27.766s CGroup: /system.slice/nvidia-fabricmanager.service â””â”€2979 /usr/bin/nv-fabricmanager -c /usr/share/nvidia/nvswitch/fabricmanager.cfg 3. NVIDIA Persistence DaemonéªŒè¯ æ£€æŸ¥æŒä¹…åŒ–å®ˆæŠ¤ç¨‹åºçŠ¶æ€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 systemctl status nvidia-persistenced â— nvidia-persistenced.service - NVIDIA Persistence Daemon Loaded: loaded (/lib/systemd/system/nvidia-persistenced.service; enabled; vendor preset: enabled) Active: active (running) since Fri 2023-05-07 15:13:59 CST; 3 months 16 days ago Main PID: 304182 (nvidia-persiste) Tasks: 1 (limit: 629145) Memory: 360.0K CPU: 214ms CGroup: /system.slice/nvidia-persistenced.service â””â”€304182 /usr/bin/nvidia-persistenced --verbose ","permalink":"https://www.itwp.cn/categories/article/ubuntu-nvidia/","summary":"\u003ch2 id=\"ä¸€-åŸºç¡€ç¯å¢ƒå‡†å¤‡\"\u003eä¸€. åŸºç¡€ç¯å¢ƒå‡†å¤‡\u003c/h2\u003e\n\u003ch3 id=\"1-ç³»ç»Ÿä¼˜åŒ–\"\u003e1. ç³»ç»Ÿä¼˜åŒ–\u003c/h3\u003e\n\u003ch4 id=\"1-é”å®šå†…æ ¸ç‰ˆæœ¬\"\u003e1. é”å®šå†…æ ¸ç‰ˆæœ¬\u003c/h4\u003e\n\u003cp\u003eé˜²æ­¢ç³»ç»Ÿè‡ªåŠ¨å‡çº§å¯¼è‡´é©±åŠ¨ä¸å…¼å®¹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eapt-mark hold linux-generic linux-image-generic linux-headers-generic\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"2-å…³é—­è‡ªåŠ¨æ›´æ–°\"\u003e2. å…³é—­è‡ªåŠ¨æ›´æ–°\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-1-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-2\"\u003e2\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo sed -i.bak \u003cspan class=\"s1\"\u003e\u0026#39;s/1/0/\u0026#39;\u003c/span\u003e /etc/apt/apt.conf.d/10periodic \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u0026gt; /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo sed -i.bak \u003cspan class=\"s1\"\u003e\u0026#39;s/1/0/\u0026#39;\u003c/span\u003e /etc/apt/apt.conf.d/20auto-upgrades \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u0026gt; /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"2-ä¾èµ–å®‰è£…\"\u003e2. ä¾èµ–å®‰è£…\u003c/h3\u003e\n\u003cp\u003eå®‰è£…ç¼–è¯‘å¿…éœ€çš„å·¥å…·ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-2-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-2-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eapt install gcc make -y\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"äºŒ-é©±åŠ¨ä¸‹è½½\"\u003eäºŒ. é©±åŠ¨ä¸‹è½½\u003c/h2\u003e\n\u003ch3 id=\"1-nvidia-driverä¸‹è½½\"\u003e1. NVIDIA Driverä¸‹è½½\u003c/h3\u003e\n\u003cp\u003eè®¿é—®NVIDIAå®˜æ–¹é©±åŠ¨ä¸‹è½½é¡µé¢ï¼š\nå®˜æ–¹é“¾æ¥: \u003ca href=\"https://www.nvidia.cn/drivers/lookup/\"\u003ehttps://www.nvidia.cn/drivers/lookup/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"NVIDIAé©±åŠ¨ä¸‹è½½é¡µé¢\" loading=\"lazy\" src=\"/images/ubuntu-nvidia/image1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæ ¹æ®æ‚¨çš„GPUå‹å·å’Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬é€‰æ‹©åˆé€‚çš„é©±åŠ¨ç‰ˆæœ¬ã€‚ä¸‹è½½åä¼šè·å¾—ä¸€ä¸ª\u003ccode\u003e.run\u003c/code\u003eå®‰è£…åŒ…ï¼Œç›´æ¥ä¸Šä¼ åˆ°æœåŠ¡å™¨å³å¯ã€‚\u003c/p\u003e\n\u003ch3 id=\"2-cudaä¸‹è½½\"\u003e2. CUDAä¸‹è½½\u003c/h3\u003e\n\u003cp\u003eè®¿é—®NVIDIA CUDAä¸‹è½½é¡µé¢ï¼š\nå®˜æ–¹é“¾æ¥: \u003ca href=\"https://developer.nvidia.com/cuda-downloads\"\u003ehttps://developer.nvidia.com/cuda-downloads\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"CUDAä¸‹è½½é¡µé¢\" loading=\"lazy\" src=\"/images/ubuntu-nvidia/image2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eé€‰æ‹©å¯¹åº”çš„æ“ä½œç³»ç»Ÿã€æ¶æ„å’Œç‰ˆæœ¬ï¼Œæ¨èä¸‹è½½\u003ccode\u003e.run\u003c/code\u003eæ ¼å¼çš„å®‰è£…åŒ…ï¼Œä¾¿äºè‡ªå®šä¹‰å®‰è£…é€‰é¡¹ã€‚\u003c/p\u003e\n\u003ch3 id=\"3-nvidia-fabric-managerä¸‹è½½\"\u003e3. NVIDIA Fabric Managerä¸‹è½½\u003c/h3\u003e\n\u003cp\u003eæ³¨ï¼šä»…SXMæ¥å£çš„GPUéœ€è¦ï¼ŒPCIeæ¥å£çš„GPUä¸éœ€è¦æ­¤ç»„ä»¶ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-3-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-3-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2004/x86_64/nvidia-fabricmanager-535_535.154.05-1_amd64.deb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"ä¸‰-é©±åŠ¨å®‰è£…\"\u003eä¸‰. é©±åŠ¨å®‰è£…\u003c/h2\u003e\n\u003ch3 id=\"1-nvidia-driverå®‰è£…\"\u003e1. NVIDIA Driverå®‰è£…\u003c/h3\u003e\n\u003cp\u003eä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…NVIDIAé©±åŠ¨ï¼ˆæ ¹æ®å®é™…ç‰ˆæœ¬å·ä¿®æ”¹ï¼‰ï¼š\u003c/p\u003e","title":"Ubuntu NVIDIAé©±åŠ¨éƒ¨ç½²"},{"content":"ç‰©ç†æœºéƒ¨ç½² rocm è¶…ç®—GPUå¹³å° https://download.pytorch.org/whl/torch_stable.html\nsource /opt/rocm/env.sh æˆ–è€… module load /root/dtkxxx\nenv.sh å†…å®¹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/bash # get DTKROOT by env.sh location DTKROOT=\u0026#34;$(cd \u0026#34;$(dirname \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; \u0026amp;\u0026amp; pwd)/$(basename \u0026#34;${BASH_SOURCE[0]}\u0026#34;)\u0026#34; export DTKROOT=$(dirname $DTKROOT) export AMDGPU_TARGETS=\u0026#34;gfx906\u0026#34; export ROCM_PATH=$DTKROOT export HIP_PATH=${ROCM_PATH}/hip export PATH=$ROCM_PATH/bin:$ROCM_PATH/opencl/bin:$ROCM_PATH/llvm/bin:$ROCM_PATH/hip/bin:$PATH export LD_LIBRARY_PATH=${ROCM_PATH}/lib:${ROCM_PATH}/opencl/lib:${ROCM_PATH}/lib64:$LD_LIBRARY_PATH export LD_LIBRARY_PATH=${ROCM_PATH}/hip/lib:${ROCM_PATH}/llvm/lib:$LD_LIBRARY_PATH export C_INCLUDE_PATH=${ROCM_PATH}/include:${ROCM_PATH}/llvm/include${C_INCLUDE_PATH:+:${C_INCLUDE_PATH}} export CPLUS_INCLUDE_PATH=${ROCM_PATH}/include:${ROCM_PATH}/llvm/include${CPLUS_INCLUDE_PATH:+:${CPLUS_INCLUDE_PATH}} rocm-smi æŸ¥çœ‹GPU\ndocker éƒ¨ç½²eth \u0026ndash;gfx906 è¶…ç®—GPUå¹³å° 1 docker run -it --name testa1 --env-file ./env --device=/dev/dri --device=/dev/kfd jupyter:v1 /bin/bash è¯´æ˜ï¼š\n--device æŒ‡å®šGPUé©±åŠ¨è·¯å¾„ --env-file æŒ‡å®šenvæ–‡ä»¶ï¼Œæœ¬æ–‡ä»¶å†…å£°æ˜ä»£ç†èŠ‚ç‚¹ï¼Œç”¨äºä»£ç†ä¸Šç½‘ envæ–‡ä»¶å†…å®¹å¦‚ä¸‹:\n1 2 3 proxy=http://sugonhsq:HfJSZ*j*@10.10.101.4:3333 http_proxy=http://sugonhsq:HfJSZ*j*@10.10.101.4:3333 https_proxy=http://sugonhsq:HfJSZ*j*@10.10.101.4:3333 è°ƒç”¨redminiï¼š\n--benchmark ä¼šæ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¸æŠŠåœ°å€å‘é€å‡ºå»\n1 ./teamredminer -a ethash --benchmark -o stratum+ssl://156.226.17.84:6677 -u 0x9Eefd5CB1CD01574bac349a9a92b01064FEF543C -p x FAQ docker ä¸­æ— æ³•è°ƒç”¨opencl è¯´æ˜ï¼š\nopenclè·¯å¾„ï¼š/opt/rocm/opencl/bin/clinfo è®¾ç½®å˜é‡ PATH=$PATH:/opt/rocm/opencl/bin/ [root@localhost ~]# rocm-smi æ˜¾ç¤º \u0026ldquo;There are no card\u0026rdquo; é—®é¢˜å¤„ç†ï¼š\n1. æ— æ³•ä½¿ç”¨clinfo æŸ¥çœ‹openclå¹³å° è§£å†³åŠæ³•ï¼šdocker é•œåƒä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è·¯å¾„å¦‚ä¸‹\n1 2 mkdir -p /etc/OpenCL/vendors/ vim /etc/OpenCL/vendors/amdocl64.icd æ–‡ä»¶å†…å®¹ï¼š\n1 libamdocl64.so 2. åˆ›å»ºåº“æ–‡ä»¶åè¿˜æ˜¯æŠ¥é”™ï¼Œéœ€è¦å£°æ˜å˜é‡ 1 2 export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/dtk/opencl/lib export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/rocm/opencl/lib é…ç½®ï¼š\n1 permitRootLogin yes teamredminer - å£°æ˜ä¸€ä¸‹openclçš„è·¯å¾„\n3. \u0026ldquo;there are no card\u0026quot;æŠ¥é”™ æ›´æ–°å†…æ ¸åå’Œé©±åŠ¨ä¸é€‚é…ï¼Œä¸èƒ½æ›´æ–°å†…æ ¸\næ›™å…‰æ–¹å¾·ç³»ç»ŸæŸ¥çœ‹æ˜¾å¡çŠ¶æ€ å·®åˆ« hy-smi å’Œ rocm-smi çš„åŒºåˆ« hy-smi:\nhy-smiå°±æ˜¯å°è£…çš„rocm-smi å¯ä»¥è¿™æ ·ç†è§£dtkå°±æ˜¯æŠŠrocmå°è£…äº†ä¸‹ï¼Œåœ¨dcu1-2å·éƒ½èƒ½ç”¨ rocm-smi:\nä¸è¿‡rocm-smi æ˜¯ç›´æ¥è°ƒç”¨çš„ rocmè¶…ç®—å¹³å° æœ¬è´¨ä¸Šæ²¡ä»€åŒºåˆ« sugonæ–¹å¾·ç³»ç»Ÿ:\nå†…æ ¸ç‰ˆæœ¬ 957 å¦‚ä¸‹å›¾\n","permalink":"https://www.itwp.cn/categories/article/rocm-docker/","summary":"\u003ch2 id=\"ç‰©ç†æœºéƒ¨ç½²-rocm-è¶…ç®—gpuå¹³å°\"\u003eç‰©ç†æœºéƒ¨ç½² rocm è¶…ç®—GPUå¹³å°\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://download.pytorch.org/whl/torch_stable.html\"\u003ehttps://download.pytorch.org/whl/torch_stable.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003esource /opt/rocm/env.sh æˆ–è€… module load /root/dtkxxx\u003c/p\u003e\n\u003cp\u003eenv.sh å†…å®¹å¦‚ä¸‹\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-0-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-1\"\u003e 1\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-2\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-2\"\u003e 2\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-3\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-3\"\u003e 3\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-4\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-4\"\u003e 4\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-5\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-5\"\u003e 5\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-6\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-6\"\u003e 6\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-7\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-7\"\u003e 7\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-8\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-8\"\u003e 8\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-9\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-9\"\u003e 9\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-10\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-10\"\u003e10\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-11\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-11\"\u003e11\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-12\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-12\"\u003e12\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-13\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-13\"\u003e13\u003c/a\u003e\n\u003c/span\u003e\u003cspan class=\"lnt\" id=\"hl-0-14\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-0-14\"\u003e14\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# get DTKROOT by env.sh location\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDTKROOT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edirname \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBASH_SOURCE\u003c/span\u003e\u003cspan class=\"p\"\u003e[0]\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nb\"\u003epwd\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003ebasename \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBASH_SOURCE\u003c/span\u003e\u003cspan class=\"p\"\u003e[0]\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eDTKROOT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edirname \u003cspan class=\"nv\"\u003e$DTKROOT\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eAMDGPU_TARGETS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;gfx906\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$DTKROOT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eHIP_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/hip\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$ROCM_PATH\u003c/span\u003e/bin:\u003cspan class=\"nv\"\u003e$ROCM_PATH\u003c/span\u003e/opencl/bin:\u003cspan class=\"nv\"\u003e$ROCM_PATH\u003c/span\u003e/llvm/bin:\u003cspan class=\"nv\"\u003e$ROCM_PATH\u003c/span\u003e/hip/bin:\u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/lib:\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/opencl/lib:\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/lib64:\u003cspan class=\"nv\"\u003e$LD_LIBRARY_PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/hip/lib:\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/llvm/lib:\u003cspan class=\"nv\"\u003e$LD_LIBRARY_PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eC_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/include:\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/llvm/include\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eC_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"p\"\u003e:+:\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eC_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eCPLUS_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/include:\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eROCM_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/llvm/include\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eCPLUS_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"p\"\u003e:+:\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eCPLUS_INCLUDE_PATH\u003c/span\u003e\u003cspan class=\"si\"\u003e}}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003erocm-smi æŸ¥çœ‹GPU\u003c/p\u003e\n\u003ch2 id=\"docker-éƒ¨ç½²eth-gfx906-è¶…ç®—gpuå¹³å°\"\u003edocker éƒ¨ç½²eth \u0026ndash;gfx906 è¶…ç®—GPUå¹³å°\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\" id=\"hl-1-1\"\u003e\u003ca class=\"lnlinks\" href=\"#hl-1-1\"\u003e1\u003c/a\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -it --name testa1 --env-file ./env --device\u003cspan class=\"o\"\u003e=\u003c/span\u003e/dev/dri --device\u003cspan class=\"o\"\u003e=\u003c/span\u003e/dev/kfd jupyter:v1 /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eè¯´æ˜ï¼š\u003c/p\u003e","title":"Dockerè°ƒç”¨ROCM"}]